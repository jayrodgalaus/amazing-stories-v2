<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <title>PptxGenJS Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DXC C&I PH Amazing Stories - A platform to share and celebrate commendations within the DXC community.">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/theme.css">
    <link href='https://fonts.googleapis.com/css?family=Anaheim' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="https://alcdn.msauth.net/browser/2.16.1/js/msal-browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/powerbi-client/dist/powerbi.js"></script>
</head>
<body>
    <!-- Modals -->  
        <!-- General Modal -->
        <div class="modal fade" id="generalModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="modal-title"></h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" class="position-relative">
                        <p id="modal-message"></p>
                    </div>  
                </div>
            </div>
        </div>
        <!-- Confirm Modal -->
        <div class="modal fade" id="confirmModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5">Confirm</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" class="position-relative">
                        <p id="confirmMessage"></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="confirmModalBtn">Confirm</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="confirmModalCancel">Close</button>
                    </div>
                </div>
            </div>
        </div>
    <div id="home-page" class="position-relative">
        <div id="cycleBG" backgroundImage="1" class="text-light">
            <i class="fa-solid fa-arrows-spin"></i>
        </div>
        <div class="d-flex flex-column align-items-center justify-content-center w-70 h-100">
            <div id="landing" class="container px-5 text-light">
                <h1>C&I PH Amazing Stories</h1>
                <p class="lead mt-3 text-light">One of our company's key priorities is to celebrate and learn from each other's experience. Let's continue to inspire others through amplified storytelling, showcasing the maximum work we do for ourselves, our teams, and our clients.</p>
                
                <button class="btn btn-primary btn-lg" id="signIn">Sign In</button>
                <!-- <button id="generate">Generate PPTX</button> -->
            </div>
            <div id="starting" class="container px-5 d-none text-light">
                <h1>Welcome, <span class="username"></span>.</h1>
                <p class="lead mt-3">Quickly get started by clicking on one of the options below.</p>
                <button class="btn btn-primary mt-2 me-2 spoc-element d-none" id="openAddEntry" type="button" data-bs-toggle="offcanvas" data-bs-target="#addEntryCanvas" aria-controls="addEntryCanvas">New entry</button>
                <button class="btn btn-primary mt-2 me-2" id="openGenerateSlide" type="button" data-bs-toggle="offcanvas" data-bs-target="#generateSlidesCanvas" aria-controls="generateSlidesCanvas">Entry List</button>
                <button class="btn btn-primary mt-2 me-2" id="openDashboard" type="button" data-bs-toggle="offcanvas" data-bs-target="#dashboardCanvas" aria-controls="dashboardCanvas">Dashboard</button>
                <button class="btn btn-primary mt-2 me-2 spoc-element d-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#guideQuestionsCanvas" aria-controls="guideQuestionsCanvas" id="openGuideQuestions">Guide Questions</button>
                <button class="btn btn-secondary mt-2" type="button" id="signOut">Sign Out</button>
            </div>
        </div>
        
        
    </div>
    <div class="offcanvas offcanvas-end vw-100 spoc-element d-none" tabindex="-1" id="addEntryCanvas" aria-labelledby="addEntryLabel">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title">New Entry</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <!-- <div class="container">
                <div class="row">
                    <div class="col">
                        <form class="needs-validation" novalidate id="newEntryForm">
                            <div class="row">
                                <div class="col">
                                    <label for="monthDropdown" class="mt-2">Month</label>
                                    <select class="form-select" id="monthDropdown" aria-describedby="monthDropdown" required>
                                        <option value="January">January</option>
                                        <option value="February">February</option>
                                        <option value="March">March</option>
                                        <option value="April">April</option>
                                        <option value="May">May</option>
                                        <option value="June">June</option>
                                        <option value="July">July</option>
                                        <option value="August">August</option>
                                        <option value="September">September</option>
                                        <option value="October">October</option>
                                        <option value="November">November</option>
                                        <option value="December">December</option>
                                    </select>
                                </div>
                                <div class="col">
                                    <label for="subslDropdown" class="mt-2">SUB-SL</label>
                                    <select class="form-select" id="subslDropdown" aria-describedby="subslDropdown" required>
                                        <option value="" disabled selected>--Select SUB-SL--</option>
                                        <option value="AMS-EU">AMS-EU</option>
                                        <option value="APJ-MEA">APJ-MEA</option>
                                        <option value="CDM Shared">CDM Shared</option>
                                        <option value="CIBC">CIBC</option>
                                        <option value="EAO">EAO</option>
                                        <option value="Network">Network</option>
                                        <option value="PM & PMO">PM & PMO</option>
                                        <option value="PM + EAO + SDEX">PM + EAO + SDEX</option>
                                        <option value="VPC">VPC</option>
                                        
                                    </select>
                                    <div class="invalid-feedback">Please select SUB-SL.</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label for="accountDropdown" class="mt-2">Account</label>
                                    <select class="form-select" id="accountDropdown" aria-describedby="accountDropdown" required>
                                        <option value="" disabled selected>--Select an account--</option>
                                        <option value="AgGateway">AgGateway</option>
                                        <option value="Airbus">Airbus</option>
                                        <option value="Amcor">Amcor</option>
                                        <option value="AON">AON</option>
                                        <option value="AT&T">AT&T</option>
                                        <option value="Audi">Audi</option>
                                        <option value="Avanos">Avanos</option>
                                        <option value="Aviva">Aviva Canada</option>
                                        <option value="BOQ">Bank of Queensland</option>
                                        <option value="Betafence">Betafence</option>
                                        <option value="BlueScope">BlueScope Steel</option>
                                        <option value="CIBC">Canadian Imperial Bank of Commerce</option>
                                        <option value="Coca-Cola">Coca-Cola Beverages Philippines</option>
                                        <option value="DirecTV">DirecTV</option>
                                        <option value="Downer">Downer</option>
                                        <option value="DXC Technology">DXC Technology</option>
                                        <option value="Fischer">Fischer</option>
                                        <option value="Glanbia">Glanbia</option>
                                        <option value="Global Life Sciences Products and Services">Global Life Sciences Products and Services</option>
                                        <option value="Hanes Brands Inc.">Hanes Brands Inc.</option>
                                        <option value="HF Sinclair">HF Sinclair</option>
                                        <option value="IAG">IAG</option>
                                        <option value="Japan Tobacco Inc.">Japan Tobacco Inc.</option>
                                        <option value="Jollibee Foods Corporation">Jollibee Foods Corporation</option>
                                        <option value="Kraft Heinz">Kraft Heinz</option>
                                        <option value="Leveraged">Leveraged</option>
                                        <option value="Latitude Financial Services">Latitude Financial Services</option>
                                        <option value="Macquarie">Macquarie</option>
                                        <option value="Markem-Imaje">Markem-Imaje</option>
                                        <option value="Medmix">Medmix</option>
                                        <option value="Microsoft">Microsoft</option>
                                        <option value="Nissan">Nissan</option>
                                        <option value="ONE">Ocean Network Express</option>
                                        <option value="Oceana">Oceana</option>
                                        <option value="Origin">Origin Energy Services Limited</option>
                                        <option value="Philips">Philips</option>
                                        <option value="P&G">Proctor & Gamble</option>
                                        <option value="Pilmico">Pilmico Foods Corporation</option>
                                        <option value="Radisson">Radisson Hotel Group</option>
                                        <option value="Ralph Lauren">Ralph Lauren</option>
                                        <option value="Sabre">Sabre</option>
                                        <option value="Serco">Serco</option>
                                        <option value="Siam Cement Group">Siam Cement Group</option>
                                        <option value="Sotheby's">Sotheby's</option>
                                        <option value="South Australian Health">South Australian Health</option>
                                        <option value="Sulzer">Sulzer</option>
                                        <option value="ThyssenKrupp">ThyssenKrupp</option>
                                        <option value="Toronto Dominion Bank">Toronto Dominion Bank</option>
                                        <option value="Uniper">Uniper</option>
                                        <option value="Valeo">Valeo</option>
                                        <option value="Ventia">Ventia</option>
                                        <option value="Western Sydney Airport">Western Sydney Airport</option>
                                        <option value="Westpac">Westpac</option>
                                        <option value="Whitehaven Coal">Whitehaven Coal</option>
                                        <option value="W.L. Gore">W.L. Gore</option>
                                        <option value="Worksafe Victoria">Worksafe Victoria</option>
                                        <option value="other">Others &#40;please specify&#41;</option>
                                    </select>
                                    <div class="invalid-feedback">Please select an account.</div>
                                    <div style="display: none;" id="otherAccountContainer">
                                        <input type="text" class="form-control mt-2" id="otherAccountInput" placeholder="Please specify">
                                        <div class="invalid-feedback">Please provide a valid account name.</div>
                                    </div>
                                </div>
                                <div class="col">
                                    <label for="teamInput" class="mt-2">Team</label>
                                    <input type="text" class="form-control" id="teamInput" required placeholder="Team name">
                                    <div class="invalid-feedback">Please provide a valid team name.</div>
                                </div>
                            </div>
                            <label for="classificationSelect" class="mt-2 spoc-element">Commendation Classification</label>
                            <select class="form-select spoc-element" id="classificationSelect" aria-describedby="classificationSelect">
                                <option selected value="C&I PH Commendation">C&I PH Commendation</option>
                                <option value="Account Commendation">Account Commendation</option>
                                <option value="Client Commendation">Client Commendation</option>
                            </select>   
                            <label for="entryInput" class="mt-2">Entry Title</label>
                            <input type="text" class="form-control" id="entryInput" maxlength="64" placeholder="Maximum 64 characters" required>
                            <div class="invalid-feedback">Please provide a valid entry title.</div>
                            <label for="recipientInput" class="mt-2">Recipient Names</label>
                            <div class="d-flex">
                                <input type="text " class="form-control" id="recipientInput" placeholder="Search recipient...">
                                <button class="btn btn-secondary ms-2" type="button" id="otherRecipientOption"><span class="small">Others</span></button>
                            </div>
                            
                            <div id="recipientDropdown"></div>
                            <div class="d-none" id="otherRecipientContainer">
                                <input type="text" class="form-control mt-2" id="otherRecipientInput" placeholder="Name">
                                <input type="email" class="form-control ms-2 mt-2" id="otherRecipientEmailInput" value="no.email@dxc.com" placeholder="Email">
                                <button class="btn btn-primary ms-2 mt-2 small" type="button" id="addOtherRecipient">Add</button>
                            </div>
                            <div class="mt-2" id="recipientContainer"></div>
                            <div class="d-flex align-items-center">
                                <label class="mt-2">Individual / Team Recognition</label>
                                <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recognitionInfo"><i class="fa-solid fa-info"></i></button>
                            </div>
                            <div class="d-flex">
                                <div class="recognitionPill px-2 text-center" id="recognitionInput1Label">Individual</div>
                                <div class="recognitionPill px-2 text-center" id="recognitionInput2Label">Team</div>
                                <input class="float-end" type="radio" name="recognitionInput" id="recognitionInput1" style="opacity: 0;pointer-events: none;">
                                <input class="float-end" type="radio" name="recognitionInput" id="recognitionInput2" style="opacity: 0;pointer-events: none;">
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <label for="recipientImages" class="mt-2">Recipient Images</label>
                                <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recipientImagesInfo"><i class="fa-solid fa-info"></i></button>
                            </div>
                            <input type="file" class="form-control" id="recipientImages" name="images" accept=".png, .jpg, .jpeg" multiple>
                            <div id="previewContainer" class="preview-section mt-2 d-flex">
                                
                            </div>
                            <label for="typeOfWork" class="mt-2">Type of Work</label>
                            <select class="form-select" id="typeOfWork" aria-describedby="typeOfWork" required>
                                <option value="" disabled selected>--Select type of work--</option>
                                <option value="Automation">Automation</option>
                                <option value="Backup">Backup</option>
                                <option value="Change Management">Change Management</option>
                                <option value="Change Implementation">Change Implementation</option>
                                <option value="File Transfer">File Transfer</option>
                                <option value="Go Live">Go Live</option>
                                <option value="Hardware Refresh">Hardware Refresh</option>
                                <option value="Incident Management">Incident Management</option>
                                <option value="Innovation">Innovation</option>
                                <option value="Migration cutover/ Rollout">Migration cutover/ Rollout</option>
                                <option value="Network Monitoring">Network Monitoring</option>
                                <option value="Operations Support">Operations Support</option>
                                <option value="Patching">Patching</option>
                                <option value="Problem Management">Problem Management</option>
                                <option value="Project Implementation">Project Implementation</option>
                                <option value="Project Management">Project Management</option>
                                <option value="Server Build">Server Build</option>
                                <option value="Storage Migration">Storage Migration</option>
                                <option value="Systems Upgrade">Systems Upgrade</option>
                                <option value="Vulnerability Management">Vulnerability Management</option>
                                <option value="others">Others &#40;please specify&#41;</option>
                            </select>
                            <input type="text" class="form-control mt-2" id="otherTypeOfWorkInput" placeholder="Please specify" style="display: none;">
                            <div class="invalid-feedback">Please provide a valid type of work.</div>
                            <div class="d-flex align-items-center">
                                <label for="businessChallengeInput" class="mt-2">Business Challenge</label>
                                <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessChallengeInfo"><i class="fa-solid fa-info"></i></button>
                            </div>                
                            <textarea class="form-control" id="businessChallengeInput" rows="4" required></textarea>
                            <div class="invalid-feedback">Please provide a valid business challenge.</div>
                            <div class="d-flex align-items-center">
                                <label for="businessImpactInput" class="mt-2">Business Impact</label>
                                <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessImpactInfo"><i class="fa-solid fa-info"></i></button>
                            </div>
                            <textarea class="form-control" id="businessImpactInput" rows="4" required></textarea>
                            <div class="invalid-feedback">Please provide a valid business impact.</div>
                            <div class="d-flex align-items-center mt-2">
                                <input class="form-check-input me-2" type="checkbox" id="uniquenessTickbox">
                                <label class="form-check-label" for="uniquenessTickbox">Add Uniqueness/Complexity</label>
                                <button type="button" class="info-button bg-secondary-subtle" id="uniquenessInfo"><i class="fa-solid fa-info"></i></button>
                            </div>
                            <textarea class="form-control" id="uniquenessInput" rows="4"  style="display: none;"></textarea>
                            <div class="invalid-feedback">Please provide a valid uniqueness/complexity.</div>
                            <div class="d-flex align-items-center">
                                <label for="howDXCHelpedInput" class="mt-2">How DXC Helped</label>
                                <button type="button" class="info-button mt-2 bg-secondary-subtle" id="howDXCHelpedInfo"><i class="fa-solid fa-info"></i></button>
                            </div>
                            <textarea class="form-control" id="howDXCHelpedInput" rows="4" required></textarea>
                            <div class="invalid-feedback">Please provide a valid description.</div>
                            
                            
                            
                            <button type="submit" class="btn btn-primary float-end my-3">Submit</button>
                        </form>
                    </div>
                    <div class="col"></div>
                </div>
            </div> -->
            <div class="container">
                <div class="d-flex justify-content-center w-100 mx-auto">
                    <form class="needs-validation w-50" novalidate id="newEntryForm">
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <label for="classificationSelect" class="mt-2 spoc-element">Commendation Classification</label>
                                        <select class="form-select spoc-element" id="classificationSelect" aria-describedby="classificationSelect">
                                            <option selected value="C&I PH Commendation">C&I PH Commendation</option>
                                            <option value="Account Commendation">Account Commendation</option>
                                            <option value="Client Commendation">Client Commendation</option>
                                        </select>   
                                    </div>
                                    <div class="col">
                                        <label for="monthDropdown" class="mt-2">For the Month of</label>
                                        <select class="form-select" id="monthDropdown" aria-describedby="monthDropdown" required>
                                            <option value="January">January</option>
                                            <option value="February">February</option>
                                            <option value="March">March</option>
                                            <option value="April">April</option>
                                            <option value="May">May</option>
                                            <option value="June">June</option>
                                            <option value="July">July</option>
                                            <option value="August">August</option>
                                            <option value="September">September</option>
                                            <option value="October">October</option>
                                            <option value="November">November</option>
                                            <option value="December">December</option>
                                        </select>
                                    </div>
                                </div>
                                <label for="entryInput" class="mt-2">Entry Title</label>
                                <input type="text" class="form-control" id="entryInput" maxlength="64" placeholder="Maximum 64 characters" required>
                                <div class="invalid-feedback">Please provide a valid entry title.</div>
                            </div>
                        </div>
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <div class="row">
                                    
                                    <div class="col">
                                        <label for="subslDropdown" class="mt-2">SUB-SL</label>
                                        <select class="form-select" id="subslDropdown" aria-describedby="subslDropdown" required>
                                            <option value="" disabled selected>--Select SUB-SL--</option>
                                            <option value="AMS-EU">AMS-EU</option>
                                            <option value="APJ-MEA">APJ-MEA</option>
                                            <option value="CDM Shared">CDM Shared</option>
                                            <option value="CIBC">CIBC</option>
                                            <option value="EAO">EAO</option>
                                            <option value="Network">Network</option>
                                            <option value="PM & PMO">PM & PMO</option>
                                            <option value="PM + EAO + SDEX">PM + EAO + SDEX</option>
                                            <option value="VPC">VPC</option>
                                            <!-- <option value="C&I">C&I</option> -->
                                        </select>
                                        <div class="invalid-feedback">Please select SUB-SL.</div>
                                    </div>
                                    <div class="col">
                                        <label for="accountDropdown" class="mt-2">Account</label>
                                        <select class="form-select" id="accountDropdown" aria-describedby="accountDropdown" required>
                                            <option value="" disabled selected>--Select an account--</option>
                                            <option value="ADBRI">ADBRI</option>
                                            <option value="AgGateway">AgGateway</option>
                                            <option value="Airbus">Airbus</option>
                                            <option value="Amcor">Amcor</option>
                                            <option value="AON">AON</option>
                                            <option value="AT&T">AT&T</option>
                                            <option value="Audi">Audi</option>
                                            <option value="Avanos">Avanos</option>
                                            <option value="Aviva">Aviva Canada</option>
                                            <option value="BOQ">Bank of Queensland</option>
                                            <option value="Betafence">Betafence</option>
                                            <option value="BlueScope">BlueScope Steel</option>
                                            <option value="Calvo">Calvo</option>
                                            <option value="CIBC">Canadian Imperial Bank of Commerce</option>
                                            <option value="Coca-Cola">Coca-Cola Beverages Philippines</option>
                                            <option value="DirecTV">DirecTV</option>
                                            <option value="Downer">Downer</option>
                                            <option value="Duracell">Duracell</option>
                                            <option value="DXC Technology">DXC Technology</option>
                                            <option value="Fischer">Fischer</option>
                                            <option value="Glanbia">Glanbia</option>
                                            <option value="Global Life Sciences Products and Services">Global Life Sciences Products and Services</option>
                                            <option value="Haleon">Haleon</option>
                                            <option value="Hanes Brands Inc.">Hanes Brands Inc.</option>
                                            <option value="Hitachi">Hitachi Construction</option>
                                            <option value="HF Sinclair">HF Sinclair</option>
                                            <option value="HSC BSO">HSC BSO</option>
                                            <option value="IAG">IAG</option>
                                            <option value="Japan Tobacco Inc.">Japan Tobacco Inc.</option>
                                            <option value="Jollibee Foods Corporation">Jollibee Foods Corporation</option>
                                            <option value="Kraft Heinz">Kraft Heinz</option>
                                            <option value="KBR">KBR</option>
                                            <option value="Leveraged">Leveraged</option>
                                            <option value="Latitude Financial Services">Latitude Financial Services</option>
                                            <option value="Macquarie">Macquarie</option>
                                            <option value="Markem-Imaje">Markem-Imaje</option>
                                            <option value="Medmix">Medmix</option>
                                            <option value="Microsoft">Microsoft</option>
                                            <option value="Nestle">Nestle</option>
                                            <option value="Nissan">Nissan</option>
                                            <option value="ONE">Ocean Network Express</option>
                                            <option value="Oceana">Oceana</option>
                                            <option value="Origin">Origin Energy Services Limited</option>
                                            <option value="Philips">Philips</option>
                                            <option value="P&G">Proctor & Gamble</option>
                                            <option value="Pilmico">Pilmico Foods Corporation</option>
                                            <option value="Radisson">Radisson Hotel Group</option>
                                            <option value="Ralph Lauren">Ralph Lauren</option>
                                            <option value="Sabre">Sabre</option>
                                            <option value="Serco">Serco</option>
                                            <option value="Siam Cement Group">Siam Cement Group</option>
                                            <option value="Sonneborn">Sonneborn</option>
                                            <option value="Sotheby's">Sotheby's</option>
                                            <option value="South Australian Health">South Australian Health</option>
                                            <option value="Sulzer">Sulzer</option>
                                            <option value="ThyssenKrupp">ThyssenKrupp</option>
                                            <option value="Tops Markets LLC">Tops Markets LLC</option>
                                            <option value="Toronto Dominion Bank">Toronto Dominion Bank</option>
                                            <option value="Transport for NSW">Transport for NSW</option>
                                            <option value="Uniper">Uniper</option>
                                            <option value="Valeo">Valeo</option>
                                            <option value="Ventia">Ventia</option>
                                            <option value="Western Sydney Airport">Western Sydney Airport</option>
                                            <option value="Western Union">Western Union</option>
                                            <option value="Westpac">Westpac</option>
                                            <option value="Whitehaven Coal">Whitehaven Coal</option>
                                            <option value="W.L. Gore">W.L. Gore</option>
                                            <option value="Worksafe Victoria">Worksafe Victoria</option>
                                            <option value="ZF WABCO">ZF WABCO</option>
                                            <option value="other">Others &#40;please specify&#41;</option>
                                        </select>
                                        <div class="invalid-feedback">Please select an account.</div>
                                        <div style="display: none;" id="otherAccountContainer">
                                            <input type="text" class="form-control mt-2" id="otherAccountInput" placeholder="Please specify">
                                            <div class="invalid-feedback">Please provide a valid account name.</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <label for="teamInput" class="mt-2">Team</label>
                                <input type="text" class="form-control" id="teamInput" required placeholder="Team name">
                                <div class="invalid-feedback">Please provide a valid team name.</div>
                            
                        
                                <div class="d-flex align-items-center">
                                    <label for="recipientInput" class="mt-2">Recipient Names</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recipientNamesInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <div class="d-flex">
                                    <input type="text " class="form-control" id="recipientInput" placeholder="Search recipient...">
                                    <button class="btn btn-secondary ms-2" type="button" id="otherRecipientOption"><span class="small">Others</span></button>
                                </div>
                                
                                <div id="recipientDropdown"></div>
                                <div class="d-none" id="otherRecipientContainer">
                                    <input type="text" class="form-control mt-2" id="otherRecipientInput" placeholder="Name">
                                    <input type="email" class="form-control ms-2 mt-2" id="otherRecipientEmailInput" value="no.email@dxc.com" placeholder="Email">
                                    <button class="btn btn-primary ms-2 mt-2 small" type="button" id="addOtherRecipient">Add</button>
                                </div>
                                <div class="mt-2" id="recipientContainer"></div>
                                <div class="d-flex align-items-center">
                                    <label class="mt-2">Individual / Team Recognition</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recognitionInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <div class="d-flex">
                                    <div class="recognitionPill px-2 text-center" id="recognitionInput1Label">Individual</div>
                                    <div class="recognitionPill px-2 text-center" id="recognitionInput2Label">Team</div>
                                    <input class="float-end" type="radio" name="recognitionInput" id="recognitionInput1" style="opacity: 0;pointer-events: none;">
                                    <input class="float-end" type="radio" name="recognitionInput" id="recognitionInput2" style="opacity: 0;pointer-events: none;">
                                </div>
                                
                                <div class="d-flex align-items-center">
                                    <label for="recipientImages" class="mt-2">Recipient Images</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recipientImagesInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <input type="file" class="form-control" id="recipientImages" name="images" accept=".png, .jpg, .jpeg" multiple>
                                <div id="previewContainer" class="preview-section mt-2 d-flex">
                                    <!-- Previews will be added here -->
                                </div>
                            </div>
                        </div>
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <label for="typeOfWork" class="mt-2">Type of Work</label>
                                <select class="form-select" id="typeOfWork" aria-describedby="typeOfWork" required>
                                    <option value="" disabled selected>--Select type of work--</option>
                                    <option value="Automation">Automation</option>
                                    <option value="Backup">Backup</option>
                                    <option value="Change Management">Change Management</option>
                                    <option value="Change Implementation">Change Implementation</option>
                                    <option value="File Transfer">File Transfer</option>
                                    <option value="Go Live">Go Live</option>
                                    <option value="Hardware Refresh">Hardware Refresh</option>
                                    <option value="Incident Management">Incident Management</option>
                                    <option value="Innovation">Innovation</option>
                                    <option value="Migration cutover/ Rollout">Migration cutover/ Rollout</option>
                                    <option value="Network Monitoring">Network Monitoring</option>
                                    <option value="Operations Support">Operations Support</option>
                                    <option value="Patching">Patching</option>
                                    <option value="Problem Management">Problem Management</option>
                                    <option value="Project Implementation">Project Implementation</option>
                                    <option value="Project Management">Project Management</option>
                                    <option value="Server Build">Server Build</option>
                                    <option value="Storage Migration">Storage Migration</option>
                                    <option value="Systems Upgrade">Systems Upgrade</option>
                                    <option value="Vulnerability Management">Vulnerability Management</option>
                                    <option value="others">Others &#40;please specify&#41;</option>
                                </select>
                                <input type="text" class="form-control mt-2" id="otherTypeOfWorkInput" placeholder="Please specify" style="display: none;">
                                <div class="invalid-feedback">Please provide a valid type of work.</div>
                                <div class="d-flex align-items-center">
                                    <label for="businessChallengeInput" class="mt-2">Customer Challenge</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessChallengeInfo"><i class="fa-solid fa-info"></i></button>
                                </div>                
                                <textarea class="form-control" id="businessChallengeInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid business challenge.</div>
                                <div class="d-flex align-items-center">
                                    <label for="businessImpactInput" class="mt-2">Customer Impact</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessImpactInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="businessImpactInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid business impact.</div>
                                <div class="d-flex align-items-center mt-2">
                                    <input class="form-check-input me-2" type="checkbox" id="uniquenessTickbox">
                                    <label class="form-check-label" for="uniquenessTickbox">Add Uniqueness/Complexity</label>
                                    <button type="button" class="info-button bg-secondary-subtle" id="uniquenessInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="uniquenessInput" rows="4"  style="display: none;"></textarea>
                                <div class="invalid-feedback">Please provide a valid uniqueness/complexity.</div>
                                <div class="d-flex align-items-center">
                                    <label for="howDXCHelpedInput" class="mt-2">How DXC Helped</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="howDXCHelpedInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="howDXCHelpedInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid description.</div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary float-end mb-3 shadow">Submit</button>
                    </form>
                    <button type="button" title="Help" class="help-btn my-3 ms-3 d-flex shadow justify-content-center align-items-center" data-bs-toggle="offcanvas" data-bs-target="#helpCanvas" aria-controls="helpCanvas" data-title="New Entry Help" data-carousel="newEntryCarousel"><i class="fa-solid fa-question"></i></button>
                </div>
            </div>
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100 spoc-element d-none" tabindex="-1" id="updateEntryCanvas" aria-labelledby="updateEntryCanvas">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title">Update Entry</h3>
            <button type="button" id="updateEntryCanvasClose" class="btn-close" data-bs-toggle="offcanvas" aria-label="Close" data-bs-target="#generateSlidesCanvas" aria-controls="generateSlidesCanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div class="container">
                <div class="d-flex justify-content-center w-50 mx-auto">
                    <form class="needs-validation w-100" novalidate id="updateEntryForm">
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <input type="hidden" name="updateId" id="updateId" value="">
                                <input type="hidden" name="attachmentsToDelete" id="attachmentsToDelete" value="[]">
                                <div class="row">
                                    <div class="col">
                                        <label for="updateClassificationSelect" class="mt-2 spoc-element">Commendation Classification</label>
                                        <select class="form-select spoc-element" id="updateClassificationSelect" aria-describedby="updateClassificationSelect">
                                            <option selected value="C&I PH Commendation">C&I PH Commendation</option>
                                            <option value="Account Commendation">Account Commendation</option>
                                            <option value="Client Commendation">Client Commendation</option>
                                        </select>  
                                    </div> 
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <label for="updateYearInput" class="mt-2">Year</label>
                                        <input type="number" min="2023" max="2099" class="form-control" id="updateYearInput" required placeholder="Year" step="1">
                                    </div>
                                    <div class="col">
                                        <label for="updateMonthDropdown" class="mt-2">For the Month of</label>
                                        <select class="form-select" id="updateMonthDropdown" aria-describedby="updateMonthDropdown" required>
                                            <option value="January">January</option>
                                            <option value="February">February</option>
                                            <option value="March">March</option>
                                            <option value="April">April</option>
                                            <option value="May">May</option>
                                            <option value="June">June</option>
                                            <option value="July">July</option>
                                            <option value="August">August</option>
                                            <option value="September">September</option>
                                            <option value="October">October</option>
                                            <option value="November">November</option>
                                            <option value="December">December</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <label for="updateEntryInput" class="mt-2">Entry Title</label>
                                        <input type="text" class="form-control" id="updateEntryInput" maxlength="64" placeholder="Maximum 64 characters" required>
                                        <div class="invalid-feedback">Please provide a valid entry title.</div>
                                    </div>
                                </div>
                            </div>  
                        </div>  
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <label for="updateSubslDropdown" class="mt-2">SUB-SL</label>
                                        <select class="form-select" id="updateSubslDropdown" aria-describedby="updateSubslDropdown" required>
                                            <option value="" disabled selected>--Select SUB-SL--</option>
                                            <option value="AMS-EU">AMS-EU</option>
                                            <option value="APJ-MEA">APJ-MEA</option>
                                            <option value="CDM Shared">CDM Shared</option>
                                            <option value="CIBC">CIBC</option>
                                            <option value="EAO">EAO</option>
                                            <option value="Network">Network</option>
                                            <option value="PM & PMO">PM & PMO</option>
                                            <option value="PM + EAO + SDEX">PM + EAO + SDEX</option>
                                            <option value="VPC">VPC</option>
                                            <!-- <option value="C&I">C&I</option> -->
                                        </select>
                                        <div class="invalid-feedback">Please select SUB-SL.</div>
                                    </div>
                                    <div class="col">
                                        <label for="updateAccountDropdown" class="mt-2">Account</label>
                                        <select class="form-select" id="updateAccountDropdown" aria-describedby="updateAccountDropdown">
                                            <option value="" disabled selected>--Select an account--</option>
                                            <option value="ADBRI">ADBRI</option>
                                            <option value="AgGateway">AgGateway</option>
                                            <option value="Airbus">Airbus</option>
                                            <option value="Amcor">Amcor</option>
                                            <option value="AON">AON</option>
                                            <option value="AT&T">AT&T</option>
                                            <option value="Audi">Audi</option>
                                            <option value="Avanos">Avanos</option>
                                            <option value="Aviva">Aviva Canada</option>
                                            <option value="BOQ">Bank of Queensland</option>
                                            <option value="Betafence">Betafence</option>
                                            <option value="BlueScope">BlueScope Steel</option>
                                            <option value="Calvo">Calvo</option>
                                            <option value="CIBC">Canadian Imperial Bank of Commerce</option>
                                            <option value="Coca-Cola">Coca-Cola Beverages Philippines</option>
                                            <option value="DirecTV">DirecTV</option>
                                            <option value="Downer">Downer</option>
                                            <option value="Duracell">Duracell</option>
                                            <option value="DXC Technology">DXC Technology</option>
                                            <option value="Fischer">Fischer</option>
                                            <option value="Glanbia">Glanbia</option>
                                            <option value="Global Life Sciences Products and Services">Global Life Sciences Products and Services</option>
                                            <option value="Haleon">Haleon</option>
                                            <option value="Hanes Brands Inc.">Hanes Brands Inc.</option>
                                            <option value="Hitachi">Hitachi Construction</option>
                                            <option value="HF Sinclair">HF Sinclair</option>
                                            <option value="HSC BSO">HSC BSO</option>
                                            <option value="IAG">IAG</option>
                                            <option value="Japan Tobacco Inc.">Japan Tobacco Inc.</option>
                                            <option value="Jollibee Foods Corporation">Jollibee Foods Corporation</option>
                                            <option value="Kraft Heinz">Kraft Heinz</option>
                                            <option value="KBR">KBR</option>
                                            <option value="Leveraged">Leveraged</option>
                                            <option value="Latitude Financial Services">Latitude Financial Services</option>
                                            <option value="Macquarie">Macquarie</option>
                                            <option value="Markem-Imaje">Markem-Imaje</option>
                                            <option value="Medmix">Medmix</option>
                                            <option value="Microsoft">Microsoft</option>
                                            <option value="Nestle">Nestle</option>
                                            <option value="Nissan">Nissan</option>
                                            <option value="ONE">Ocean Network Express</option>
                                            <option value="Oceana">Oceana</option>
                                            <option value="Origin">Origin Energy Services Limited</option>
                                            <option value="Philips">Philips</option>
                                            <option value="P&G">Proctor & Gamble</option>
                                            <option value="Pilmico">Pilmico Foods Corporation</option>
                                            <option value="Radisson">Radisson Hotel Group</option>
                                            <option value="Ralph Lauren">Ralph Lauren</option>
                                            <option value="Sabre">Sabre</option>
                                            <option value="Serco">Serco</option>
                                            <option value="Siam Cement Group">Siam Cement Group</option>
                                            <option value="Sonneborn">Sonneborn</option>
                                            <option value="Sotheby's">Sotheby's</option>
                                            <option value="South Australian Health">South Australian Health</option>
                                            <option value="Sulzer">Sulzer</option>
                                            <option value="ThyssenKrupp">ThyssenKrupp</option>
                                            <option value="Tops Markets LLC">Tops Markets LLC</option>
                                            <option value="Toronto Dominion Bank">Toronto Dominion Bank</option>
                                            <option value="Transport for NSW">Transport for NSW</option>
                                            <option value="Uniper">Uniper</option>
                                            <option value="Valeo">Valeo</option>
                                            <option value="Ventia">Ventia</option>
                                            <option value="Western Sydney Airport">Western Sydney Airport</option>
                                            <option value="Western Union">Western Union</option>
                                            <option value="Westpac">Westpac</option>
                                            <option value="Whitehaven Coal">Whitehaven Coal</option>
                                            <option value="W.L. Gore">W.L. Gore</option>
                                            <option value="Worksafe Victoria">Worksafe Victoria</option>
                                            <option value="ZF WABCO">ZF WABCO</option>
                                            <option value="other">Others &#40;please specify&#41;</option>
                                        </select>
                                        <div class="invalid-feedback">Please select an account.</div>
                                        <div style="display: none;" id="updateOtherAccountContainer">
                                            <input type="text" class="form-control mt-2" id="updateOtherAccountInput" placeholder="Please specify">
                                            <div class="invalid-feedback" id="updateOtherAccountFeedback">Please provide a valid account name.</div>
                                        </div>
                                    </div>
                                </div>
                                <label for="updateTeamInput" class="mt-2">Team</label>
                                <input type="text" class="form-control" id="updateTeamInput" required placeholder="Team name">
                                <div class="invalid-feedback">Please provide a valid team name.</div>
                                <div class="d-flex align-items-center">
                                    <label for="updateRecipientInput" class="mt-2">Recipient Names</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recipientNamesInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <div class="d-flex">
                                    <input type="text " class="form-control" id="updateRecipientInput" placeholder="Search recipient...">
                                    <button class="btn btn-secondary ms-2" type="button" id="updateOtherRecipientOption"><span class="small">Others</span></button>
                                </div>
                                <div id="updateRecipientDropdown"></div>
                                <div class="mt-2" id="updateRecipientContainer"></div>
                                <div class="d-none" id="updateOtherRecipientContainer">
                                    <input type="text" class="form-control mt-2" id="updateOtherRecipientInput" placeholder="Name">
                                    <input type="email" class="form-control ms-2 mt-2" id="updateOtherRecipientEmailInput" value="no.email@dxc.com" placeholder="Email">
                                    <button class="btn btn-primary ms-2 mt-2 small" type="button" id="updateAddOtherRecipient">Add</button>
                                </div>
                                <div class="d-flex align-items-center">
                                    <label class="mt-2">Individual / Team Recognition</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recognitionInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <div class="d-flex">
                                    <div class="updateRecognitionPill px-2 text-center" id="updateRecognitionInput1Label">Individual</div>
                                    <div class="updateRecognitionPill px-2 text-center" id="updateRecognitionInput2Label">Team</div>
                                    <input class="float-end" type="radio" name="updateRecognitionInput" id="updateRecognitionInput1" style="opacity: 0;pointer-events: none;">
                                    <input class="float-end" type="radio" name="updateRecognitionInput" id="updateRecognitionInput2" style="opacity: 0;pointer-events: none;">
                                </div>
                                
                                <div class="d-flex align-items-center">
                                    <label for="updateRecipientImages" class="mt-2">Add Recipient Images</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="recipientImagesInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <input type="file" class="form-control" id="updateRecipientImages" name="images" accept=".png, .jpg, .jpeg" multiple>
                                <div id="updatePreviewContainer" class="preview-section mt-2 d-flex">
                                    <!-- Previews will be added here -->
                                </div>
                                <label for="" class="mt-2">Existing Images</label>
                                <div id="existingPreviewContainer" class="preview-section mt-2 d-flex">
                                    No images.
                                </div>
                                
                            </div>
                        </div>
                        <div class="card shadow my-3">
                            <div class="card-body">
                                <label for="updateTypeOfWork" class="mt-2">Type of Work</label>
                                <select class="form-select" id="updateTypeOfWork" aria-describedby="typeOfWork" required>
                                    <option value="" disabled selected>--Select type of work--</option>
                                    <option value="Automation">Automation</option>
                                    <option value="Backup">Backup</option>
                                    <option value="Change Management">Change Management</option>
                                    <option value="Change Implementation">Change Implementation</option>
                                    <option value="File Transfer">File Transfer</option>
                                    <option value="Go Live">Go Live</option>
                                    <option value="Hardware Refresh">Hardware Refresh</option>
                                    <option value="Incident Management">Incident Management</option>
                                    <option value="Innovation">Innovation</option>
                                    <option value="Migration cutover/ Rollout">Migration cutover/ Rollout</option>
                                    <option value="Network Monitoring">Network Monitoring</option>
                                    <option value="Operations Support">Operations Support</option>
                                    <option value="Patching">Patching</option>
                                    <option value="Problem Management">Problem Management</option>
                                    <option value="Project Implementation">Project Implementation</option>
                                    <option value="Project Management">Project Management</option>
                                    <option value="Server Build">Server Build</option>
                                    <option value="Storage Migration">Storage Migration</option>
                                    <option value="Systems Upgrade">Systems Upgrade</option>
                                    <option value="Vulnerability Management">Vulnerability Management</option>
                                    <option value="others">Others &#40;please specify&#41;</option>
                                </select>
                                <input type="text" class="form-control mt-2" id="updateOtherTypeOfWorkInput" placeholder="Please specify" style="display: none;">
                                <div class="invalid-feedback">Please provide a valid type of work.</div>
                                <div class="d-flex align-items-center">
                                    <label for="updateBusinessChallengeInput" class="mt-2">Customer Challenge</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessChallengeInfo"><i class="fa-solid fa-info"></i></button>
                                </div>                
                                <textarea class="form-control" id="updateBusinessChallengeInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid business challenge.</div>
                                <div class="d-flex align-items-center">
                                    <label for="updateBusinessImpactInput" class="mt-2">Customer Impact</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="businessImpactInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="updateBusinessImpactInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid business impact.</div>
                                <div class="d-flex align-items-center mt-2">
                                    <input class="form-check-input me-2" type="checkbox" id="updateUniquenessTickbox">
                                    <label class="form-check-label" for="updateUniquenessTickbox">Add Uniqueness/Complexity</label>
                                    <button type="button" class="info-button bg-secondary-subtle" id="uniquenessInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="updateUniquenessInput" rows="4"  style="display: none;"></textarea>
                                <div class="invalid-feedback">Please provide a valid uniqueness/complexity.</div>
                                <div class="d-flex align-items-center">
                                    <label for="updateHowDXCHelpedInput" class="mt-2">How DXC Helped</label>
                                    <button type="button" class="info-button mt-2 bg-secondary-subtle" id="howDXCHelpedInfo"><i class="fa-solid fa-info"></i></button>
                                </div>
                                <textarea class="form-control" id="updateHowDXCHelpedInput" rows="4" required></textarea>
                                <div class="invalid-feedback">Please provide a valid description.</div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary float-end my-3">Update</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100 pb-3" tabindex="-1" id="generateSlidesCanvas" aria-labelledby="generateSlidesCanvas">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title">Entry List</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="row">
                <div class="col">
                    <div class="d-flex p-3">
                        <div class="btn-group spoc-element d-none" role="group">
                            <input type="radio" class="btn-check" name="entryFilter" value="1" id="entryFilter1" autocomplete="off">
                            <label class="btn btn-sm btn-outline-primary entryFilterLabel" for="entryFilter1" value="1">All Entries</label>
                            <input type="radio" class="btn-check" name="entryFilter" value="2" id="entryFilter2" autocomplete="off" checked>
                            <label class="btn btn-sm btn-outline-primary entryFilterLabel" for="entryFilter2" value="2">My Entries</label>
                            <input type="radio" class="btn-check" name="entryFilter" value="3" id="entryFilter3" autocomplete="off">
                            <label class="btn btn-sm btn-outline-primary entryFilterLabel" for="entryFilter3" value="3">My Recognition</label>
                        </div>
                        <button class="btn btn-sm btn-primary entryFilterLabel other-element d-none" value="3">My Recognition</button>
                        <div class="ms-auto d-flex">
                            <select id="sorter" class="form-select form-select-sm me-2">
                                <option value="0">Sort by</option>
                                <option value="1">&uarr;Entry Date</option>
                                <option value="2">&darr;Entry Date</option>
                                <option value="3">&uarr;Submitter</option>
                                <option value="4">&darr;Submitter</option>
                                <option value="5" class="month-sort">&uarr;Month</option>
                                <option value="6" class="month-sort">&darr;Month</option>
                                <option value="7">&uarr;Account</option>
                                <option value="8">&darr;Account</option>
                            </select>
                            <select id="subslFilter" class="form-select form-select-sm me-2 super-element d-none">
                                <option value="All">All SUB-SL</option>
                                <option value="AMS-EU">AMS-EU</option>
                                <option value="APJ-MEA">APJ-MEA</option>
                                <option value="CDM Shared">CDM Shared</option>
                                <option value="CIBC">CIBC</option>
                                <option value="EAO">EAO</option>
                                <option value="Network">Network</option>
                                <option value="PM & PMO">PM & PMO</option>
                                <option value="PM + EAO + SDEX">PM + EAO + SDEX</option>
                                <option value="VPC">VPC</option>
                            </select>
                            <select id="monthFilter" class="form-select form-select-sm">
                                <option value="All">All Months</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col position-relative">
                    <button type="button" title="Help" class="help-btn my-3 ms-3 d-flex shadow justify-content-center align-items-center" data-bs-toggle="offcanvas" data-bs-target="#helpCanvas" aria-controls="helpCanvas" data-title="Entry List Help" data-carousel="entryListCarousel"><i class="fa-solid fa-question"></i></button>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div id="entriesContainer" class="px-3 pb-3 w-100 h-100">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                </div>
                <div class="col" id="entryPreviewContainer">
                    <div class="card h-100">
                        <div class="card-body h-100 scroll-hover" style="overflow-y: auto;">
                            <div class="lead text-theme d-flex h-100 w-100 align-items-center justify-content-center" id="entryPreviewPlaceholder">Click on an entry to preview.</div>
                            <div id="entryPreview" class="d-none px-4">
                                <div class="h3 fw-bold text-theme" id="entryPreviewTitle"></div>
                                <div>
                                    <p class="text-muted mb-0">
                                        Submitted by <span id="entryPreviewSubmittedBy"></span> on <span  id="entryPreviewSubmittedOn"></span><br>
                                        For the month of <span id="entryPreviewMonth"></span>, <span id="entryPreviewYear"></span>
                                    </p>
                                    <div id="entryPreviewBadges">
                                        <span class="badge rounded-pill text-bg-primary" id="entryPreviewSubsl"></span>
                                        <span class="badge rounded-pill text-bg-light" id="entryPreviewTeam"></span>
                                    </div>
                                </div>
                                <hr>
                                <div class="h5 fw-bold text-theme">Type of Work</div>
                                <div><p class="preview-paragraph" id="entryPreviewWorkType"></p></div>
                                <div class="h5 fw-bold text-theme">Customer Challenge</div>
                                <div><p class="preview-paragraph" id="entryPreviewChallenge"></p></div>
                                <div class="h5 fw-bold text-theme">Customer Impact</div>
                                <div><p class="preview-paragraph" id="entryPreviewImpact"></p></div>
                                <div class="h5 fw-bold text-theme">Uniqueness/Complexity</div>
                                <div><p class="preview-paragraph" id="entryPreviewUniqueness"></p></div>
                                <div class="h5 fw-bold text-theme">How DXC Helped</div>
                                <div><p class="preview-paragraph" id="entryPreviewHelp"></p></div>
                                <div class="h5 fw-bold text-theme">Attachments</div>
                                <div>Please view the full entry to see attachments.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
            <!-- <div class="d-flex">
                <ul class="list-group month-list-group">
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#JanuaryEntries" role="tab" aria-controls="JanuaryEntries">January</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#FebruaryEntries" role="tab" aria-controls="FebruaryEntries">February</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#MarchEntries" role="tab" aria-controls="MarchEntries">March</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#AprilEntries" role="tab" aria-controls="AprilEntries">April</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#MayEntries" role="tab" aria-controls="MayEntries">May</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#JuneEntries" role="tab" aria-controls="JuneEntries">June</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#JulyEntries" role="tab" aria-controls="JulyEntries">July</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#AugustEntries" role="tab" aria-controls="AugustEntries">August</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#SeptemberEntries" role="tab" aria-controls="SeptemberEntries">September</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#OctoberEntries" role="tab" aria-controls="OctoberEntries">October</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#NovemberEntries" role="tab" aria-controls="NovemberEntries">November</li>
                    <li class="list-group-item nav-link" data-bs-toggle="tab" data-bs-target="#DecemberEntries" role="tab" aria-controls="DecemberEntries">December</li>
                </ul>
                <div class="tab-content flex-grow-1">
                    <div class="tab-pane fade h-100" id="JanuaryEntries" role="tabpanel" aria-labelledby="JanuaryEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="FebruaryEntries" role="tabpanel" aria-labelledby="FebruaryEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="MarchEntries" role="tabpanel" aria-labelledby="MarchEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="AprilEntries" role="tabpanel" aria-labelledby="AprilEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="MayEntries" role="tabpanel" aria-labelledby="MayEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="JuneEntries" role="tabpanel" aria-labelledby="JuneEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="JulyEntries" role="tabpanel" aria-labelledby="JulyEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="AugustEntries" role="tabpanel" aria-labelledby="AugustEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="SeptemberEntries" role="tabpanel" aria-labelledby="SeptemberEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="OctoberEntries" role="tabpanel" aria-labelledby="OctoberEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="NovemberEntries" role="tabpanel" aria-labelledby="NovemberEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade h-100" id="DecemberEntries" role="tabpanel" aria-labelledby="DecemberEntries" tabindex="0">
                        <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                            <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100" tabindex="-1" id="dashboardCanvas" aria-labelledby="dashboardCanvas">
        
        <div class="offcanvas-body position-relative" style="overflow:hidden">
            <button type="button" class="btn-close position-absolute" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            <iframe title="Amazing Stories" width="1140" height="541.25" src="https://app.powerbi.com/reportEmbed?reportId=ca6ef729-4261-480c-8728-d4a7345af6e7&autoAuth=true&ctid=93f33571-550f-43cf-b09f-cd331338d086" frameborder="0" allowFullScreen="true"></iframe>
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100" tabindex="-1" id="entryInfoCanvas" aria-labelledby="entryInfoCanvas">
        <div class="offcanvas-header">
            <h4 class="offcanvas-title">Entry Info</h4>
            <button type="button" class="btn-close" data-bs-toggle="offcanvas" data-bs-target="#generateSlidesCanvas" aria-controls="generateSlidesCanvas" aria-label="Close"  id="EntryInfoClose"></button>
        </div>
        <div class="offcanvas-body">
            <div id="entryLoading" class="w-100 h-100 d-flex align-items-center justify-content-center">
                <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
                <div class="spinner-grow spinner-grow-sm text-primary mx-1" role="status"></div>
            </div>
            <div class="d-flex w-100 h-100 justify-content-center" id="entryInfoCard" style="display: none;">
                <div class="card shadow w-75 h-100">
                    <div class="card-body d-flex flex-column" style="overflow: hidden; ">
                        <div class="d-flex align-items-center">
                            <span id="entryInfoEntry" class="h3 fw-bold w-60 text-theme">Successful Go-live of Branch and Netsec Operations </span>
                            <img src="assets/img/logos/CIBC.jpg" id="entryInfoLogo" class="ms-auto" alt="" style="max-height: 100px; max-width: 200px;">
                        </div>
                        <div class="d-flex">
                            <div class="h4 m-0"><span id="entryInfoSubSL"></span> - <span id="entryInfoTeam"></span></div>
                        </div>
                        <div class="text-muted">
                            Submitted by <span id="entryInfoCreatedBy" class="fw-bold">John Doe</span> on <span id="entryInfoCreatedOn">April 22, 2025</span>. For the month of <b><span id="entryInfoMonth">April</span>, <span id="entryInfoYear">2025</span></b>
                        </div>
                        <hr>
                        <div class="d-flex w-100 h-100" style="overflow-y: hidden;">
                            <div class="card w-30 h-100 flex-column me-3" style="overflow-y: auto; min-width: fit-content;">
                                <div class="card-body pe-5 scroll-hover"  style="overflow-y: auto; background-color: #5F249F !important; color: white;">
                                    <div class="h5 fw-bold">Recipients</div>
                                    <div id="entryInfoRecipients" style="white-space: nowrap;"></div>  
                                </div>
    
                            </div>
                            
                            <!-- <div class="h-50 mx-5" style="align-self: center; border-right: 1px solid rgba(0,0,0,0.25);"></div> -->
                            <div class="flex-grow-1 h-100">
                                <div class="card h-100">
                                    <div class="card-body h-100 scroll-hover" style="overflow-y: auto;">
                                        <div class="h5 fw-bold text-theme">Type of Work</div>
                                        <div><p id="entryInfoWorkType"></p></div>
                                        <div class="h5 fw-bold text-theme">Customer Challenge</div>
                                        <div><p  id="entryInfoChallenge"></p></div>
                                        <div class="h5 fw-bold text-theme">Customer Impact</div>
                                        <div><p id="entryInfoImpact"></p></div>
                                        <div class="h5 fw-bold text-theme">Uniqueness/Complexity</div>
                                        <div><p id="entryInfoUniqueness"></p></div>
                                        <div class="h5 fw-bold text-theme">How DXC Helped</div>
                                        <div><p id="entryInfoHelp"></p></div>
                                        <div class="h5 fw-bold text-theme">Attachments</div>
                                        <div id="entryInfoImages"></div>
                                    </div>
                                </div>
                                
                            </div>
                            
                        </div>
    
                        
                    </div>
                </div>
                <div class="d-flex flex-column ms-3 spoc-element" id="entryInfoActions" style="display: none;">
                    <button type="button" data-id="" class="entry-amplify mb-3 d-flex shadow justify-content-center align-items-center super-element" id="entryInfoAmplifyBtn"><i class="fa-solid fa-circle-up"></i></button>
                    <button type="button" data-id="" class="entry-update mb-3 d-flex shadow justify-content-center align-items-center" data-bs-toggle="offcanvas" data-bs-target="#updateEntryCanvas" aria-controls="updateEntryCanvas" id="entryInfoEditBtn"><i class="fa-solid fa-pen"></i></button>
                    <button type="button" data-id="" class="entry-delete mb-3 d-flex shadow justify-content-center align-items-center" id="entryInfoDeleteBtn"><i class="fa-solid fa-trash-can"></i></button>
                    <button type="button" data-id="" class="entry-generate mb-3 d-flex shadow justify-content-center align-items-center" id="entryInfoGenerateSlidesBtn"><i class="fa-solid fa-file-powerpoint"></i></button>
                    <button type="button" title="Help" class="help-btn mb-3 d-flex shadow justify-content-center align-items-center" data-bs-toggle="offcanvas" data-bs-target="#helpCanvas" aria-controls="helpCanvas" data-title="Entry Info Help" data-carousel="entryInfoCarousel"><i class="fa-solid fa-question"></i></button>
                </div>
            </div>
            
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100" tabindex="-1" id="guideQuestionsCanvas" aria-labelledby="guideQuestionsCanvas">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title">Guide Questions</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body pb-5">
            <div class="container">
                <div class="vh-75">
                    <div class="row h-100">
                        <div class="col h-100">
                            <div class="d-flex h-100 flex-column justify-content-center">
                                <h4 class="text-theme" >Customer Challenge</h4>
                                <p class="lead"><b>Should answer the question “What happened”?</b><br></p>
                                <ol>
                                    <li>What is the background of the issue? Describe the situation</li>
                                    <li>What issue needed to be solved/addressed? What problem caused the need for DXC to take action?</li>
                                    <li>What is the timeline or timeframe? Did something need to be resolved quickly? Was there an issue going on for too long?</li>
                                </ol>
                            </div>
                        </div>
                        <div class="col h-100">
                            <div class="d-flex h-100 align-items-center justify-content-center">
                                <img src="assets/img/challenge.jpg" alt="" class="w-75">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="vh-75">
                    <div class="row h-100">
                        <div class="col h-100">
                            <div class="d-flex h-100 align-items-center justify-content-center">
                                <img src="assets/img/impact.jpg" alt="" class="w-75">
                            </div>
                        </div>
                        <div class="col h-100">
                            <div class="d-flex h-100 flex-column justify-content-center">
                                <h4 class="text-theme">Customer Impact</h4>
                                <p>
                                    <b  class="lead">Should answer “What was the result or impact?”</b><br>
                                    <ol>
                                        <li>Are there any cost savings?</li>
                                        <li>Did it save on time and efforts?</li>
                                        <li>Did it give way to an opportunity for renewal of work/ contract extension or for additional work?</li>
                                    </ol>
                                </p>
                                <p>
                                    <b>Quantify Results</b><br>
                                    <ul>
                                        <li>Cost savings of X amount/quarter</li>
                                        <li>Reduced effort from X hours to Y minutes</li>
                                        <li>Reduced tickets by x % in Y months</li>
                                    </ul>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="vh-75">
                    <div class="row h-100">
                        <div class="col h-100">
                            <div class="d-flex h-100 flex-column justify-content-center">
                                <h4 class="text-theme">Uniqueness/Complexity</h4>
                                <p>
                                    <b class="lead">Should answer the question “What sets this apart from others?”</b><br>
                                    <ol>
                                        <li>Is the action/task unique? What makes this unique? Has this not been done before?</li>
                                        <li>What uniqueness does it introduce to the Customer/ Market?</li>
                                        <li>What makes this complex? Is it very technical? Is it due to time constraints? Is it due to volume of work? Are there multiple factors that need to be considered simultaneously? </li>
                                        <li>Is this an innovation?</li>
                                    </ol>
                                    <ul>
                                        <li>NON-BAU is preferred</li>
                                        <li>Can be BAU work as long as uniqueness or complexity is justified</li>
                                        <li>Client centric –impact statement</li>
                                    </ul>
                                </p>
                                <p>
                                    The amazing stories that have been justified as unique or complex will be reviewed with Cleif and can potentially become candidates for submission to global.
                                </p>
                            </div>
                        </div>
                        <div class="col h-100">
                            <div class="d-flex h-100 align-items-center justify-content-center">
                                <img src="assets/img/uniqueness.jpg" alt="" class="w-75">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="vh-75">
                    <div class="row h-100">
                        <div class="col h-100">
                            <div class="d-flex h-100 align-items-center justify-content-center">
                                <img src="assets/img/help.jpg" alt="" class="w-75">
                            </div>
                        </div>
                        <div class="col h-100">
                            <div class="d-flex h-100 flex-column justify-content-center">
                                <h4 class="text-theme">How DXC Helped</h4>
                                <p><b class="lead">Should answer the question “What did DXC do to execute the task and how we did it?”</b><br>
                                    What specific actions were taken?</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    <div class="offcanvas offcanvas-end vw-100" tabindex="-1" id="helpCanvas" aria-labelledby="helpCanvas">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title">New Entry Help</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="vh-75">
                <div id="newEntryCarousel" class="carousel slide carousel-fade h-100">
                    <div class="carousel-inner h-100">
                        <div class="carousel-item h-100 active">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture1.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture2.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture3.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture4.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture5.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture6.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture7.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture9.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture10.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture11.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture12.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture13.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/new entry/Picture14.png"></div>
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#newEntryCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#newEntryCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
                <div id="entryListCarousel" class="carousel slide carousel-fade h-100">
                    <div class="carousel-inner h-100">
                        <div class="carousel-item h-100 active">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture1.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture2.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture3.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture4.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture5.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture8.png"></div>
                        </div>
                        <div class="carousel-item h-100 super-element">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture6.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry list/Picture7.png"></div>
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#entryListCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#entryListCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
                <div id="entryInfoCarousel" class="carousel slide carousel-fade h-100">
                    <div class="carousel-inner h-100">
                        <div class="carousel-item h-100 active super-element">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry info/Picture1.png"></div>
                        </div>
                        <div class="carousel-item h-100">
                            <div class="lazy-bg w-100 h-100" data-bg="assets/img/tutorial/entry info/Picture2.png"></div>
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#entryInfoCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#entryInfoCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        const msalInstance = new msal.PublicClientApplication(msalConfig);
        var siteId, driveId, tokenResponse;
        var authorId, accountName, email, access;
        var spItems = [];
        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        const msalConfig = {
            auth: {
                clientId: "36fe1ccd-51e2-467a-ad6b-470f1bfeab6d", // Replace with your client ID
                authority: "https://login.microsoftonline.com/93f33571-550f-43cf-b09f-cd331338d086", // Replace with your tenant ID
                redirectUri: "https://amazing-stories.vercel.app/" // Replace with your redirect URI
            }

        };
    </script>
    <script src="assets/jquery/jquery-3.7.1.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/utilities.js"></script>
    <script src="assets/js/pptgen.js"></script>
    <script>
        $(document).ready(function() {
            init();
            $(document)
            .on('click', '#signIn', function(){
                signIn();
            })
            .on('click', '#signOut', async function(){
                msalInstance.logout();
            })
            .on('click','#confirmModalCancel',function(){
                $('#confirmModalBtn').off('click');
            })
            .on('click','.help-btn',function(){
                $('#helpCanvas .offcanvas-title').text($(this).data('title'));
                let carousel = $(this).attr('data-carousel');
                $('#helpCanvas .carousel').hide();
                $('#'+carousel).show();
                
            })

            .on('click', '#cycleBG', function() {
                let currentBG = parseInt($('#cycleBG').attr('backgroundImage'));
                currentBG = currentBG === 4 ? 1 : currentBG + 1; // Cycle through backgrounds 1 to 4
                
                $('#home-page').css('backgroundImage', 'url("assets/img/bg' + currentBG + '.png")');
                $(this).css('transform', 'rotate(' + (currentBG * 90) + 'deg)');
                $(this).attr('backgroundImage', currentBG);
            })
            .on('change','#subslDropdown, #updateSubslDropdown',function() {
                if($(this).val() === ""){
                    $(this)[0].setCustomValidity("Please select a valid option.");                
                } else {
                    $(this)[0].setCustomValidity("");
                }
            })
            .on('change','#accountDropdown',function() {
                console.log($(this).val())
                if ($(this).val() === 'other') {
                    $('#otherAccountContainer').show();
                    $('#otherAccountInput').prop('required', true).attr('aria-required', 'true');
                    $('#otherAccountInput').focus();
                    $(this)[0].setCustomValidity("");
                }else if($(this).val() === ""){
                    $(this)[0].setCustomValidity("Please select a valid option.");                
                } else {
                    $(this)[0].setCustomValidity("");
                    $('#otherAccountContainer').hide();
                    $('#otherAccountInput').removeProp('required').removeAttr('aria-required').removeAttr('required');
                }
            })
            .on('change','#updateAccountDropdown',function() {
                if ($(this).val() === 'other') {
                    $('#updateOtherAccountContainer').show();
                    $('#updateOtherAccountInput').prop('required', true).attr('aria-required', 'true');
                    $('#updateOtherAccountInput').focus();
                    $(this)[0].setCustomValidity("");
                }else if($(this).val() === ""){
                    $(this)[0].setCustomValidity("Please select a valid option.");                
                } else {
                    $(this)[0].setCustomValidity("");
                    $('#updateOtherAccountContainer').hide();
                    $('#updateOtherAccountInput').removeProp('required').removeAttr('aria-required').removeAttr('required');
                }
            })
            .on('click mousedown','input[name="recognitionInput"]',function(e) {
                e.preventDefault();
            })
            .on('click', '.removeRecipient', function() {
                $(this).parent().remove(); // Remove the recipient pill
                $('.recognitionPill').removeClass('bg-secondary-subtle');
                if($('.recipientPill').length === 0){
                    $('#recipientInput').focus(); 
                    $('#recipientImages').val("");
                }else if($('.recipientPill').length == 1){
                    $('#recognitionInput1').prop('checked', true);
                    $('#recognitionInput2').removeProp('checked').removeAttr('checked');
                    $('.recognitionPill').removeClass('bg-secondary-subtle');
                    $('#recognitionInput1Label').addClass('bg-secondary-subtle');
                }else{
                    $('#recognitionInput2').prop('checked', true);
                    $('#recognitionInput1').removeProp('checked').removeAttr('checked');
                    $('.recognitionPill').removeClass('bg-secondary-subtle');
                    $('#recognitionInput2Label').addClass('bg-secondary-subtle');
                }
                document.getElementById('recipientImages').value = "";
                $('#recipientImages').replaceWith($('#recipientImages').clone());
            })
            .on('click', '.updateRemoveRecipient', function() {
                $(this).parent().remove(); // Remove the recipient pill
                $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                if($('.updateRecipientPill').length === 0){
                    $('#updateRecipientInput').focus(); 
                    $('#updateRecipientImages').val("");
                }else if($('.updateRecipientPill').length == 1){
                    $('#updateRecognitionInput1').prop('checked', true);
                    $('#updateRecognitionInput2').removeProp('checked').removeAttr('checked');
                    $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                    $('#updateRecognitionInput1Label').addClass('bg-secondary-subtle');
                }else{
                    $('#updateRecognitionInput2').prop('checked', true);
                    $('#updateRecognitionInput1').removeProp('checked').removeAttr('checked');
                    $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                    $('#updateRecognitionInput2Label').addClass('bg-secondary-subtle');
                }
                document.getElementById('updateRecipientImages').value = "";
                $('#updateRecipientImages').replaceWith($('#updateRecipientImages').clone());
            })
            .on('change','#recipientImages',function(event){
                const previewContainer = document.getElementById('previewContainer');
                let maxUploads = 0;
                let groupError = "";
                let recipients = $('.recipientPill').length;
                if(recipients <= 4 && recipients > 0){
                    maxUploads = recipients; // Set maxUploads based on the number of recipients
                }else if( recipients > 4){
                    maxUploads = 1; // Default to 1 if more than 4
                    groupError = "For more than 4 recipients, it is recommended to upload <b>one</b> image in landscape orientation.";
                }
                console.log(`Max Uploads: ${maxUploads}`);
                // Clear previous previews
                previewContainer.innerHTML = '';
                const filesArray = Array.from(event.target.files); 

                // Check if the number of selected files exceeds the maximum allowed
                if(maxUploads === 0){
                    $('#recipientInput').focus();
                    document.getElementById('recipientImages').value = "";
                    $('#recipientImages').replaceWith($('#recipientImages').clone());
                    return;
                }
                if (filesArray.length > maxUploads) {
                    document.getElementById('recipientImages').value = "";
                    $('#recipientImages').replaceWith($('#recipientImages').clone());
                    showModal("Notice", "You can only upload a maximum of "+maxUploads+" image(s). "+groupError);
                    return;
                }
                
                // Loop through selected files
                /* filesArray.forEach((file, index) => {
                    if (file.type.startsWith('image/')) { // Ensure the file is an image
                        const reader = new FileReader();
                        const image = new Image();
                        reader.onload = function(e) {
                            image.onload = function () {
                                const width = image.width;
                                const height = image.height;
                                console.log(`File: ${file.name} → Width: ${width}, Height: ${height}`);
                                if( recipients > 4){
                                    if(width < height){
                                        groupError = "For more than 4 recipients, please upload <b>one</b> group image in landscape orientation.";
                                    }else if(width / height < 1.5 || width / height > 2){
                                        groupError = "For more than 4 recipients, please upload <b>one</b> group image with an aspect ratio between 1.5:1 and 2:1. For example, <b>1920x1080</b> or <b>1600x900</b>.";
                                    }
                                }
                            };
                            const div = document.createElement('div'); // Create a wrapper div
                            div.classList.add('image-wrapper'); // Optional: Add a class for styling
                            const img = document.createElement('img');
                            image.src = e.target.result; // Set the image source
                            img.src = e.target.result; // Set the image source
                            const button = document.createElement('button'); // Create a button
                            button.innerHTML = '<i class="fa-solid fa-xmark"></i>'; // Add the icon
                            button.classList.add('remove-image-button');
                            button.type = 'button';
                            // Add click event to remove the preview and update the file list
                            button.addEventListener('click', function() {
                                filesArray.splice(index, 1); // Remove the file from the array
                                div.remove(); // Remove the div from the preview container
                                updateFileInput(filesArray,'recipientImages'); // Update the fileInput element
                            });

                            div.appendChild(img); // Append the image to the wrapper div
                            div.appendChild(button); // Append the button to the wrapper div
                            previewContainer.appendChild(div); // Add the image to the preview container
                        };
                        
                        reader.readAsDataURL(file); // Read the file as a data URL
                    }
                });
 */
                for (let index = 0; index < filesArray.length; index++) {
                    const file = filesArray[index];
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        const image = new Image();

                        reader.onload = function (e) {
                            image.onload = function () {
                                const width = image.width;
                                const height = image.height;
                                console.log(`File: ${file.name} → Width: ${width}, Height: ${height}`);

                                if (recipients > 4) {
                                    if (width < height) {
                                        groupError = "For more than 4 recipients, it is recommended to upload <b>one</b> image in landscape orientation.";
                                        showModal("Error", groupError);
                                        return; // exits image.onload
                                    } else if (width / height < 1.5 || width / height > 2) {
                                        groupError = "For more than 4 recipients, it is recommended to upload <b>one</b> group image with an aspect ratio between 1.5:1 and 2:1. For example, <b>1920x1080</b> or <b>1600x900</b>.";
                                        showModal("Error", groupError);
                                        return;
                                    }
                                    $('#previewContainer').append(`<div class="m-2" id="previewDimensions"><b>Width</b>: ${width}px<br><b>Height</b>: ${height}px</div>`);
                                }
                            };

                            const div = document.createElement('div');
                            div.classList.add('image-wrapper');
                            const img = document.createElement('img');
                            image.src = e.target.result;
                            img.src = e.target.result;
                            const button = document.createElement('button');
                            button.innerHTML = '<i class="fa-solid fa-xmark"></i>';
                            button.classList.add('remove-image-button');
                            button.type = 'button';

                            button.addEventListener('click', function () {
                                filesArray.splice(index, 1);
                                div.remove();
                                updateFileInput(filesArray, 'recipientImages');
                                $('#previewContainer').find('#previewDimensions').remove();
                            });

                            div.appendChild(img);
                            div.appendChild(button);
                            previewContainer.appendChild(div);
                        };

                        reader.readAsDataURL(file);
                    }
                }

            })
            .on('change','#updateRecipientImages',function(event){
                const previewContainer = document.getElementById('updatePreviewContainer');
                let existingAttachments = $('.image-wrapper.existing:not(.marked-for-deletion)').length;
                const filesArray = Array.from(event.target.files); 
                let recipientImages = filesArray.length;
                let maxUploads = 0;
                let groupError = "";
                if($('.updateRecipientPill').length <= 4 && $('.updateRecipientPill').length > 0){
                    maxUploads = $('.updateRecipientPill').length - existingAttachments; // Set maxUploads based on the number of recipients
                }else if($('.updateRecipientPill').length > 4){
                    if(existingAttachments > 0)
                        maxUploads = 0; // Default to 0 if more than 4 and existing attachments
                    else{
                        maxUploads = 1; // Default to 1 if more than 4
                        groupError = "For more than 4 recipients, it is recommended to upload <b>one</b> image in landscape orientation.";
                    }
                        

                }

                // Clear previous previews
                previewContainer.innerHTML = '';

                // Check if the number of selected files exceeds the maximum allowed
                if(maxUploads === 0){
                    document.getElementById('updateRecipientImages').value = "";
                    $('#updateRecipientImages').replaceWith($('#updateRecipientImages').clone());
                    if($('.updateRecipientPill').length > 0){
                        $('#updateRecipientInput').focus();
                        showModal("Error", `There are already ${existingAttachments} image(s) attached.`);
                    }else{
                        $('#updateRecipientInput').focus();
                    }

                    return;
                }
                if (filesArray.length > maxUploads) {
                    document.getElementById('updateRecipientImages').value = "";
                    $('#updateRecipientImages').replaceWith($('#updateRecipientImages').clone());
                    showModal("Error", "You can only upload a maximum of "+maxUploads+" image(s). "+groupError);
                    return;
                }
                
                // Loop through selected files
                filesArray.forEach((file, index) => {
                    if (file.type.startsWith('image/')) { // Ensure the file is an image
                        const reader = new FileReader();
                        
                        reader.onload = function(e) {
                            const div = document.createElement('div'); // Create a wrapper div
                            div.classList.add('image-wrapper'); // Optional: Add a class for styling
                            const img = document.createElement('img');
                            img.src = e.target.result; // Set the image source
                            const button = document.createElement('button'); // Create a button
                            button.innerHTML = '<i class="fa-solid fa-xmark"></i>'; // Add the icon
                            button.classList.add('remove-image-button');
                            button.type = 'button';
                            // Add click event to remove the preview and update the file list
                            button.addEventListener('click', function() {
                                filesArray.splice(index, 1); // Remove the file from the array
                                div.remove(); // Remove the div from the preview container
                                updateFileInput(filesArray,'updateRecipientImages'); // Update the fileInput element
                            });

                            div.appendChild(img); // Append the image to the wrapper div
                            div.appendChild(button); // Append the button to the wrapper div
                            previewContainer.appendChild(div); // Add the image to the preview container
                        };
                        
                        reader.readAsDataURL(file); // Read the file as a data URL
                    }
                });
            })
            .on('change','#typeOfWork',function() {
                if ($(this).val() === 'others') {
                    $('#otherTypeOfWorkInput').show().prop('required', true).attr('aria-required', 'true');
                    $('#otherTypeOfWorkInput').focus();
                    $(this)[0].setCustomValidity("");
                }else if($(this).val() === ""){
                    $(this)[0].setCustomValidity("Please select a valid option.");                
                } else {
                    $(this)[0].setCustomValidity("");
                    $('#otherTypeOfWorkInput').hide().removeProp('required').removeAttr('aria-required');
                }
            })
            .on('change','#updateTypeOfWork',function() {
                if ($(this).val() === 'others') {
                    $('#updateOtherTypeOfWorkInput').show().prop('required', true).attr('aria-required', 'true');
                    $('#updateOtherTypeOfWorkInput').focus();
                    $(this)[0].setCustomValidity("");
                }else if($(this).val() === ""){
                    $(this)[0].setCustomValidity("Please select a valid option.");                
                } else {
                    $(this)[0].setCustomValidity("");
                    $('#updateOtherTypeOfWorkInput').hide().removeProp('required').removeAttr('aria-required');
                }
            })
            .on('change','#uniquenessTickbox',function() {
                if ($(this).is(':checked')) {
                    $('#uniquenessInput').show().prop('required', true).attr('aria-required', 'true');
                    $('#uniquenessInput').focus();
                } else {
                    $('#uniquenessInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                }
            })
            .on('change','#updateUniquenessTickbox',function() {
                if ($(this).is(':checked')) {
                    $('#updateUniquenessInput').show().prop('required', true).attr('aria-required', 'true');
                    $('#updateUniquenessInput').focus();
                } else {
                    $('#updateUniquenessInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                }
            })
            .on('click','.info-button',function() {
                const infoType = $(this).attr('id').replace('Info', '');
                let message = '';
                let title='';
                switch (infoType) {
                    case 'recognition':
                        message = `
                            <p>Individual / Team recognition is determined based on the number of recipients.</p>`;
                        title = 'Individual / Team Recognition';
                        break;
                    case 'recipientNames':
                        message = `
                            <p>Search the recipients on the search bar. If the recipient has already resigned or can't be found, click on <b>"Others"</b>. <br>Similarly, you can also add group or team names using <b>"Others"</b>.</p>
                            <p><b>Note:</b> Adding or changing recipients will automatically reset uploaded images.</p>
                            `;
                        title = 'Recipient Names';
                        break;
                    case 'recipientImages':
                        message = `
                            <p>Upload images of the recipients. You can select multiple images.<br></p>
                            <p><b>Note:</b> You can only upload one image per recipient, upto a maximum of 4 images. </p>
                            <p>For more than 4 recipients, it is recommended to upload <b>one</b> image in landscape orientation.</p>
                            `;
                        title = 'Recipient Images';
                        break;
                    case 'businessChallenge':
                        message = `
                        Should answer the question “What happened”?
                        <ol>
                            <li>What is the background of the issue? Describe the situation</li>
                            <li>What issue needed to be solved/addressed? What problem caused the need for DXC to take action?</li>
                            <li>What is the timeline or timeframe? Did something need to be resolved quickly? Was there an issue going on for too long?</li>
                        </ol>`;
                        title = 'Customer Challenge';
                        break;
                    case 'howDXCHelped':
                        message = 
                        `Should answer the question “What did DXC do to execute the task and how we did it?”
                        <br>What specific actions were taken?`;
                        title = 'How DXC Helped';
                        break;
                    case 'businessImpact':
                        message = `
                            Should answer “What was the result or impact?”<br>Are there any cost savings?
                            <br>Did it save on time and efforts?
                            <br>Did it give way to an opportunity for renewal of work/ contract extension or for additional work?
                            <br>Quantify Results
                            <ul>
                                <li>Cost savings of X amount/quarter</li>
                                <li>Reduced effort from X hours to Y minutes</li>
                                <li>Reduced tickets by x % in Y months</li>
                            </ul>`;
                        title = 'Customer Impact';
                        break;
                    case 'uniqueness':
                        message = 
                        `Should answer the question “What sets this apart from others?”
                            <br>Is the action/task unique? What makes this unique? Has this not been done before?
                            <br>What uniqueness does it introduce to the Customer/ Market?
                            <br>What makes this complex? Is it very technical? Is it due to time constraints? Is it due to volume of work? Are there multiple factors that need to be considered simultaneously? 
                            <br>Is this an innovation?
                            <br>NON-BAU is preferred
                            <br>Can be BAU work as long as uniqueness or complexity is justified
                            <br>Client centric –impact statement
                            <br>The amazing stories that have been justified as unique or complex will be reviewed with Cleif and can potentially become candidates for submission to global.`
                        ;
                        title = 'Uniqueness/Complexity';
                        break;
                    case 'outcome':
                        message = 'Describe the business outcome achieved through this work.';
                        title = 'Business Outcome';
                        break;
                    default:
                        message = 'No information available.';
                }
                showModal(title, message);
            })
            .on('input','#recipientInput', async function(event){
                const searchTerm = event.target.value.toLowerCase();

                if (searchTerm.length >= 2) { // Fetch users only if input is 2+ characters
                    const users = await fetchTenantUsers(searchTerm);

                    // Display suggestions in the dropdown
                    const dropdown = document.getElementById("recipientDropdown");
                    dropdown.innerHTML = ""; // Clear previous suggestions
                    users.forEach(user => {
                        const option = document.createElement("div");
                        option.textContent = `${user.name} (${user.email})`;
                        option.classList.add("recipient-dropdown-item");
                        option.setAttribute("data-user-id",user.id);
                        option.setAttribute("data-name",user.name);
                        option.setAttribute("data-email",user.email);
                        dropdown.appendChild(option);
                    });
                    $('#recipientDropdown').show();
                }
            })
            .on('input','#updateRecipientInput', async function(event){
                const searchTerm = event.target.value.toLowerCase();

                if (searchTerm.length >= 2) { // Fetch users only if input is 2+ characters
                    const users = await fetchTenantUsers(searchTerm);

                    // Display suggestions in the dropdown
                    const dropdown = document.getElementById("updateRecipientDropdown");
                    dropdown.innerHTML = ""; // Clear previous suggestions
                    users.forEach(user => {
                        const option = document.createElement("div");
                        option.textContent = `${user.name} (${user.email})`;
                        option.classList.add("update-recipient-dropdown-item");
                        option.setAttribute("data-user-id",user.id);
                        option.setAttribute("data-name",user.name);
                        option.setAttribute("data-email",user.email);
                        dropdown.appendChild(option);
                    });
                    $('#updateRecipientDropdown').show();
                }
            })
            .on('click','#otherRecipientOption',function(){
                $('#otherRecipientContainer').toggleClass('d-none d-flex');
                $('#recipientDropdown').empty().hide();
                $('#otherRecipientInput').val('');
                $('#otherRecipientEmailInput').attr('value', 'no-email@dxc.com');
            })
            .on('click','#updateOtherRecipientOption',function(){
                $('#updateOtherRecipientContainer').toggleClass('d-none d-flex');
                $('#updateRecipientDropdown').empty().hide();
                $('#updateOtherRecipientInput').val('');
                $('#updateOtherRecipientEmailInput').attr('value', 'no-email@dxc.com');
            })
            .on('click', '#addOtherRecipient',function(){
                const otherRecipientInput = $('#otherRecipientInput');
                const otherRecipientEmailInput = $('#otherRecipientEmailInput');
                const otherRecipientName = otherRecipientInput.val().trim();
                const otherRecipientEmail = otherRecipientEmailInput.val().trim();
                if(otherRecipientName === '' || otherRecipientEmail === ''){
                    showModal("Error", "Please enter a name and email for the other recipient.");
                    return;
                }
                const recipientContainer = $('#recipientContainer');
                const newRecipient = $(`<div class="recipientPill bg-secondary-subtle px-2" value="${otherRecipientEmail}" name="${otherRecipientName}">${otherRecipientName}<button class="removeRecipient" type="button"><i class="fa-solid fa-xmark"></i></button></div>`);
                recipientContainer.append(newRecipient);
                otherRecipientInput.val(''); // Clear the input field
                otherRecipientEmailInput.val(''); // Clear the email field
                $('#otherRecipientContainer').removeClass('d-flex').addClass('d-none'); // Hide the other recipient container
                $('#recipientDropdown').empty().hide(); // Clear the dropdown suggestions
                if($('.recipientPill').length > 0){
                    if($('.recipientPill').length == 1){
                        $('#recognitionInput1').prop('checked', true);
                        $('#recognitionInput2').removeProp('checked').removeAttr('checked');
                        $('.recognitionPill').removeClass('bg-secondary-subtle');
                        $('#recognitionInput1Label').addClass('bg-secondary-subtle');
                    }else{
                        $('#recognitionInput2').prop('checked', true);
                        $('#recognitionInput1').removeProp('checked').removeAttr('checked');
                        $('.recognitionPill').removeClass('bg-secondary-subtle');
                        $('#recognitionInput2Label').addClass('bg-secondary-subtle');
                    }
                }
            })
            .on('click', '#updateAddOtherRecipient',function(){
                const otherRecipientInput = $('#updateOtherRecipientInput');
                const otherRecipientEmailInput = $('#updateOtherRecipientEmailInput');
                const otherRecipientName = otherRecipientInput.val().trim();
                const otherRecipientEmail = otherRecipientEmailInput.val().trim();
                if(otherRecipientName === '' || otherRecipientEmail === ''){
                    showModal("Error", "Please enter a name and email for the other recipient.");
                    return;
                }
                const recipientContainer = $('#updateRecipientContainer');
                const newRecipient = $(`<div class="updateRecipientPill bg-secondary-subtle px-2" value="${otherRecipientEmail}" name="${otherRecipientName}">${otherRecipientName}<button class="removeRecipient" type="button"><i class="fa-solid fa-xmark"></i></button></div>`);
                recipientContainer.append(newRecipient);
                otherRecipientInput.val(''); // Clear the input field
                otherRecipientEmailInput.val(''); // Clear the email field
                $('#updateOtherRecipientContainer').removeClass('d-flex').addClass('d-none'); // Hide the other recipient container
                $('#updateRecipientDropdown').empty().hide(); // Clear the dropdown suggestions
                if($('.updateRecipientPill').length > 0){
                    if($('.updateRecipientPill').length == 1){
                        $('#updateRecognitionInput1').prop('checked', true);
                        $('#updateRecognitionInput2').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput1Label').addClass('bg-secondary-subtle');
                    }else{
                        $('#updateRecognitionInput2').prop('checked', true);
                        $('#updateRecognitionInput1').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput1Label').addClass('bg-secondary-subtle');
                    }
                }
            })
            
            .on('click','.recipient-dropdown-item',function(){
                const selectedUser = $(this).data('name');
                const userId = $(this).data('user-id');
                const email = $(this).data('email');
                const recipientContainer = $('#recipientContainer');
                const newRecipient = $(`<div class="recipientPill bg-secondary-subtle px-2" value="${email}" name="${selectedUser}">${selectedUser}<button class="removeRecipient" type="button"><i class="fa-solid fa-xmark"></i></button></div>`);
                recipientContainer.append(newRecipient);
                $('#recipientInput').val(''); // Clear the input field
                $('#recipientDropdown').empty().hide(); // Clear the dropdown suggestions
                if($('.recipientPill').length > 0){
                    if($('.recipientPill').length == 1){
                        $('#recognitionInput1').prop('checked', true);
                        $('#recognitionInput2').removeProp('checked').removeAttr('checked');
                        $('.recognitionPill').removeClass('bg-secondary-subtle');
                        $('#recognitionInput1Label').addClass('bg-secondary-subtle');
                    }else{
                        $('#recognitionInput2').prop('checked', true);
                        $('#recognitionInput1').removeProp('checked').removeAttr('checked');
                        $('.recognitionPill').removeClass('bg-secondary-subtle');
                        $('#recognitionInput2Label').addClass('bg-secondary-subtle');
                    }
                    document.getElementById('recipientImages').value = "";
                    $('#recipientImages').replaceWith($('#recipientImages').clone());// Clear the file input
                    $('#previewContainer').empty();
                }
            })
            .on('click','.update-recipient-dropdown-item',function(){
                const selectedUser = $(this).data('name');
                const userId = $(this).data('user-id');
                const email = $(this).data('email');
                const recipientContainer = $('#updateRecipientContainer');
                const newRecipient = $(`<div class="updateRecipientPill bg-secondary-subtle px-2" value="${email}" name="${selectedUser}">${selectedUser}<button class="removeRecipient" type="button"><i class="fa-solid fa-xmark"></i></button></div>`);
                recipientContainer.append(newRecipient);
                $('#updateRecipientInput').val(''); // Clear the input field
                $('#updateRecipientDropdown').empty().hide(); // Clear the dropdown suggestions
                if($('.updateRecipientPill').length > 0){
                    if($('.updateRecipientPill').length == 1){
                        $('#updateRecognitionInput1').prop('checked', true);
                        $('#updateRecognitionInput2').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput1Label').addClass('bg-secondary-subtle');
                    }else{
                        $('#updateRecognitionInput2').prop('checked', true);
                        $('#updateRecognitionInput1').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput2Label').addClass('bg-secondary-subtle');
                    }
                    $('#recipientImages').val(""); // Clear the file input
                    $('#updatePreviewContainer').empty();
                }
            })
            .on('submit','#newEntryForm', async function(e){
                e.preventDefault();
                if($('#accountDropdown').val() === ""){
                    $('#accountDropdown').setCustomValidity("Please select a valid option.");
                    $('#accountDropdown').focus();
                    return false;
                }else if ($('#subslDropdown').val() === ""){
                    $('#subslDropdown').setCustomValidity("Please select a valid option.");
                    $('#subslDropdown').focus();
                    return false;
                }else if ($('#typeOfWork').val() === ""){
                    $('#typeOfWork').setCustomValidity("Please select a valid option.");
                    $('#typeOfWork').focus();
                    return false;
                }
                let submit = $(this).find('button[type="submit"]');
                spinButton(submit);
                let list = "Amazing Stories entries";
                let data = {};
                let attachments = [];
                let form = $(this);
                let year = new Date().getFullYear().toString();
                let month = $('#monthDropdown').val();
                let subsl = $('#subslDropdown').val();
                let account = $('#accountDropdown').val() === 'other' ? $('#otherAccountInput').val().trim() : $('#accountDropdown').val();
                let team = $('#teamInput').val().trim();
                let recognition = $('input[name="recognitionInput"]:checked').attr('id') === 'recognitionInput1' ? true : false; //true for individual, false for team
                let entry = $('#entryInput').val().trim();//title field
                let recipients = [];
                let recipientEmails = [];

                if($('.recipientPill').length > 0){
                    $('.recipientPill').each(function(){
                        recipientEmails.push($(this).attr('value'));
                        recipients.push($(this).attr('name').trim());
                    });
                }else{
                    showModal("Error", "Please add at least one recipient.");
                    resetFormValidation(form);
                    stopSpinButton(submit, "Submit");
                    return;
                }
                let typeOfWork = $('#typeOfWork').val() === 'others' ? $('#otherTypeOfWorkInput').val().trim() : $('#typeOfWork').val();
                let businessChallenge = $('#businessChallengeInput').val().trim();
                let howDXCHelped = $('#howDXCHelpedInput').val().trim();
                let businessImpact = $('#businessImpactInput').val().trim();
                let uniqueness = $('#uniquenessTickbox').is(':checked') ? $('#uniquenessInput').val().trim() : null;
                let outcome = $('#outcomeTickbox').is(':checked') ? $('#outcomeInput').val().trim() : null;
                let recipientImages = $('#recipientImages')[0].files;
                
                if (recipientImages.length > 0) {
                    // Iterate through each uploaded file
                    /* Array.from(recipientImages).forEach(file => {
                        file.name = file.name+getRandomString(5);
                        attachments.push(file); // Add each file to the attachments array
                        console.log(`File added: ${file.name} (${file.type}, ${file.size} bytes)`);
                    }); 
                    imageData.append("images", recipientImages);
                    */
                    let imageData = new FormData();
                    Array.from(recipientImages).forEach(file => {
                        let fileName = file.name.split(".")[0];  // "cat2"
                        let fileExtension = file.name.split(".").pop();  // "png"
                        let newFileName = fileName + getRandomString(5) +"." + fileExtension;  // "cat2abcde.png"
                        
                        // Create a new File object with the renamed filename
                        let renamedFile = new File([file], newFileName, { type: file.type });
                        
                        attachments.push(renamedFile); // Add to attachments array
                        imageData.append("images", renamedFile); // Append renamed file to FormData
                        
                        console.log(`File added: ${renamedFile.name} (${renamedFile.type}, ${renamedFile.size} bytes)`);
                    });
                    // const response = await fetch("/api/upload", {
                    //     method: "POST",
                    //     body: imageData
                    // });

                    // const result = await response.json();
                    // console.log("Uploaded:", result);
                } else {
                    console.log("No files uploaded.");
                }
                data = {
                    "Title": entry,
                    "Year": year,
                    "Month": month,
                    "SUBSL": subsl,
                    "Account": account,
                    "Team": team,
                    "Individual": recognition,
                    "Recipients": recipients.join('/ '),
                    "Recipient_x0020_Emails": recipientEmails.join('/ '),
                    "Worktype": typeOfWork,
                    "Challenge": businessChallenge,
                    "Help": howDXCHelped,
                    "Impact": businessImpact,
                    "Uniqueness": uniqueness,
                    "Outcome": outcome,
                    "Amplified": "Entry",
                    "Submitted_x0020_By": email,
                };
                if(access.type != 3){
                    data["Classification"] = $('#classificationSelect').val();
                }
                console.log(data);
                saveToSharePoint(list, data, attachments).then(()=>{
                // saveToSharePointBatch(list, [data]).then(()=>{
                    showModal("Success", "Entry submitted successfully.");
                    $('#newEntryForm')[0].reset(); // Reset the form fields
                    $('#recipientContainer').empty(); // Clear the recipient container
                    $('#previewContainer').empty(); // Clear the preview container
                    $('#recipientImages').val(""); // Clear the file input
                    setCurrentMonth(); // Reset the month dropdown to the current month
                    $('#uniquenessInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                    updateFileInput([],'recipientImages'); // Clear the file input's FileList
                    $('#otherTypeOfWorkInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                }).catch((error) => {
                    console.error("Error saving to SharePoint:", error);
                    showModal("Error", "An error occurred while submitting the entry. Please try again.");
                })

                .finally(() => {
                    resetFormValidation(form);
                    stopSpinButton(submit, "Submit");
                });

            })
            .on('submit','#updateEntryForm',function(e){
                e.preventDefault();
                if($('#updateAccountDropdown').val() === ""){
                    $('#updateAccountDropdown').setCustomValidity("Please select a valid option.");
                    $('#updateAccountDropdown').focus();
                    return false;
                }else if ($('#updateSubslDropdown').val() === ""){
                    $('#updateSubslDropdown').setCustomValidity("Please select a valid option.");
                    $('#updateSubslDropdown').focus();
                    return false;
                }else if ($('#updateTypeOfWork').val() === ""){
                    $('#updateTypeOfWork').setCustomValidity("Please select a valid option.");
                    $('#updateTypeOfWork').focus();
                    return false;
                }
                if ($("#updateOtherAccountInput").is(":visible")) {

                }

                let submit = $(this).find('button[type="submit"]');
                spinButton(submit);
                let id = $('#updateId').val();
                let list = "Amazing Stories entries";
                let data = {};
                let attachments = [];
                let form = $(this);
                let year = $('#updateYearInput').val();
                let month = $('#updateMonthDropdown').val();
                let subsl = $('#updateSubslDropdown').val();
                let account = $('#updateAccountDropdown').val() === 'other' ? $('#updateOtherAccountInput').val().trim() : $('#updateAccountDropdown').val();
                let team = $('#updateTeamInput').val().trim();
                let recognition = $('input[name="updateRecognitionInput"]:checked').attr('id') === 'updateRecognitionInput1' ? true : false; //true for individual, false for team
                let entry = $('#updateEntryInput').val().trim(); // title field
                let recipients = [];
                let recipientEmails = [];
                let attachmentsToDelete = JSON.parse($('#attachmentsToDelete').val());
                if ($('.updateRecipientPill').length > 0) {
                    $('.updateRecipientPill').each(function() {
                        recipientEmails.push($(this).attr('value'));
                        recipients.push($(this).attr('name').trim());
                    });
                } else {
                    showModal("Error", "Please add at least one recipient.");
                    resetFormValidation(form);
                    stopSpinButton(submit, "Submit");
                    return;
                }
                let existingAttachments = $('.image-wrapper.existing').not('.marked-for-deletion').length;
                let recipientImages = $('#updateRecipientImages')[0].files;
                let typeOfWork = $('#updateTypeOfWork').val() === 'others' ? $('#updateOtherTypeOfWorkInput').val().trim() : $('#updateTypeOfWork').val();
                let businessChallenge = $('#updateBusinessChallengeInput').val().trim();
                let howDXCHelped = $('#updateHowDXCHelpedInput').val().trim();
                let businessImpact = $('#updateBusinessImpactInput').val().trim();
                let uniqueness = $('#updateUniquenessTickbox').is(':checked') ? $('#updateUniquenessInput').val().trim() : null;

                //check against number of recipients
                let totalAttachments = existingAttachments + recipientImages.length;
                let maxAttachments = $('.updateRecipientPill').length <= 4 ? $('.updateRecipientPill').length : 4;
                console.log("Total attachments: " + totalAttachments);
                if (totalAttachments > maxAttachments) {
                    showModal("Error", "You can only upload a maximum of <b>"+maxAttachments+"</b> image/s (one per recipient but maximum of 4 in total).");
                    resetFormValidation(form);
                    stopSpinButton(submit, "Submit");
                    $('#updateRecipientImages').val("");
                    return false;
                }

                // Iterate through each uploaded file
                Array.from(recipientImages).forEach(file => {
                    attachments.push(file); // Add each file to the attachments array
                    console.log(`File added: ${file.name} (${file.type}, ${file.size} bytes)`);
                });
                //compare fields
                let entryItem = spItems[id];
                
                let fields = [
                    {name:"Title", value: entry},
                    {name:"Year", value: year},
                    {name:"Month", value: month},
                    {name:"SUBSL", value: subsl},
                    {name:"Account", value: account},
                    {name:"Team", value: team},
                    {name:"Individual", value: recognition},
                    {name:"Recipients", value: recipients.join('/ ')},
                    {name:"Recipient_x0020_Emails", value: recipientEmails.join('/ ')},
                    {name:"Worktype", value: typeOfWork},
                    {name:"Challenge", value: businessChallenge},
                    {name:"Help", value: howDXCHelped},
                    {name:"Impact", value: businessImpact},
                    {name:"Uniqueness", value: uniqueness},
                ];
                if(access.type != 3){
                    let classification = $('#updateClassificationSelect').val();
                    fields.push({name:"Classification", value: classification});
                }
                let filteredFields = fields.filter(field => entryItem[field.name] !== field.value);

                // return false;
                updateSPItem("Amazing Stories entries", id, filteredFields).then(async ()=>{
                    if(attachments.length > 0){
                        await addAttachments(id, attachments).then(()=>{
                            console.log("Attachments saved successfully.");
                        }).catch((error) => {
                            console.error("Error saving attachments:", error);
                        });
                    }
                    if(attachmentsToDelete.length > 0){
                        await deleteAttachments("Amazing Stories entries", id, attachmentsToDelete).then(()=>{
                            console.log("Attachments deleted successfully.");
                            attachmentsToDelete.forEach(attachment => {
                                // Remove the corresponding image from the preview container
                                $('#entryInfoImages img[data-name="'+attachment+'"]').remove();
                            });
                            if($('#entryInfoImages img').length == 0){
                                $('#entryInfoImages').html(`<p>No attachments.</p>`)
                            }
                        }).catch((error) => {
                            console.error("Error deleting attachments:", error);
                        });
                    }
                    if(attachments.length > 0 || attachmentsToDelete.length > 0){
                        filteredFields.push({name: "Attachments", value: true});
                    }
                    sendEmail(spItems[id],filteredFields);
                    let updated = await getEntryById(id);
                    spItems[id] = updated;
                    showModal("Success", "Entry updated successfully.");
                    $('#updateEntryForm')[0].reset(); // Reset the form fields
                    $('#updateRecipientContainer').empty(); // Clear the recipient container
                    $('#updatePreviewContainer').empty(); // Clear the preview container
                    $('#updateRecipientImages').val(""); // Clear the file input
                    $('#updateOtherAccountInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                    $('#updateOtherTypeOfWorkInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                    $('#updateUniquenessInput').hide().removeProp('required').removeAttr('aria-required').removeAttr('required');
                    updateFileInput([],'updateRecipientImages'); // Clear the file input's FileList
                    $('#attachmentsToDelete').val("[]");
                    viewItem(id);
                    $('#updateEntryCanvasClose').click();
                    // let labelId = $('input[name="entryFilter"]:checked').val();
                    // $('.entryFilterLabel[value="'+labelId+'"]').click();
                }).catch((error) => {
                    console.error("Error saving to SharePoint:", error);
                    showModal("Error", "An error occurred while submitting the entry. Please try again.");
                })

                .finally(() => {
                    resetFormValidation(form);
                    stopSpinButton(submit, "Submit");
                });

            })
            .on('click','#openGenerateSlide',function(){
                let month = $('#monthFilter').val();
                var filter = $('input[name="entryFilter"]:checked').val();
                if(access.type == 3){filter = '3';}
                filterEntryList(month,filter)
            })
            .on('change','#subslFilter',function(){
                let sort = $('#sorter').val();
                let month = $('#monthFilter').val();
                var filter = $('input[name="entryFilter"]:checked').val();
                if(access.type == 3){return false;}
                filterEntryList(month,filter)
            })
            .on('change','#monthFilter',function(){
                let sort = $('#sorter').val();
                let month = $(this).val();
                var filter = $('input[name="entryFilter"]:checked').val();
                if(access.type == 3){filter = '3';}
                if(filter != 'All'){$('.month-sort').hide();}
                else{$('.month-sort').show();}
                filterEntryList(month,filter,sort);
            })
            .on('click','.entryFilterLabel',function(){
                let sort = $('#sorter').val();
                //get active month tab
                let month = $('#monthFilter').val();
                //get filter
                var filter = $(this).attr('value');
                if(access.type == 3){filter = '3';}
                if (filter == '3' && access.type != 3){
                    $('#subslFilter').addClass('d-none');
                }else{
                    $('#subslFilter').removeClass('d-none');
                }
                filterEntryList(month,filter);
                $('#entryPreviewPlaceholder').removeClass('d-none');
                $('#entryPreview').addClass('d-none');
            })
            .on('click','.entry-view', async function(){
                $('#entryInfoCard').hide();
                let entry = $(this).closest('.entry-card');
                let id = entry.data('id');
                viewItem(id);
            })
            .on('click','.entry-preview', function(){
                let id = $(this).data('id');
                let entryItem = spItems[id];
                let title = entryItem.Title;
                let year = entryItem.Year;
                let month = entryItem.Month;
                let subsl = entryItem.SUBSL;
                let account = entryItem.Account;
                let team = entryItem.Team;
                let recognition = entryItem.Individual ? "Individual" : "Team";
                let recipients = entryItem.Recipients.split('/ ');
                recipients = recipients.join(', ');
                let submittedby = entryItem.Submitted_x0020_By;
                let created = new Date(entryItem.Created);
                let typeOfWork = entryItem.Worktype;
                let challenge = entryItem.Challenge;
                let help = entryItem.Help;
                let impact = entryItem.Impact;
                let uniqueness = entryItem.Uniqueness && entryItem.Uniqueness.trim().length > 0 ? entryItem.Uniqueness : "None";
                $('#entryPreviewTitle').text(title);
                $('#entryPreviewYear').text(year);
                $('#entryPreviewMonth').text(month);
                $('#entryPreviewSubsl').text(subsl);
                $('#entryPreviewAccount').text(account);
                $('#entryPreviewTeam').text(team);
                $('#entryPreviewRecognition').text(recognition);
                $('#entryPreviewRecipients').text(recipients);
                $('#entryPreviewSubmittedBy').text(submittedby);
                $('#entryPreviewSubmittedOn').text(created.toLocaleDateString());
                $('#entryPreviewWorkType').text(typeOfWork);
                $('#entryPreviewChallenge').text(challenge);
                $('#entryPreviewHelp').text(help);
                $('#entryPreviewImpact').text(impact);
                $('#entryPreviewUniqueness').text(uniqueness);
                $('#entryPreview').removeClass('d-none');
                $('#entryPreviewPlaceholder').addClass('d-none')
            })
            .on('click','#EntryInfoClose',function(){
                $('#entryLoading').removeClass('d-none').addClass('d-flex');
                $('#entryInfoCard').hide();
                $('#entryInfoImages').html("");
                $('#entryInfoAmplifyBtn').removeClass('text-theme');
                let closebtn = $('#updateEntryCanvasClose');
                closebtn.attr('data-bs-target','#generateSlidesCanvas').attr('aria-controls','generateSlidesCanvas');
            })
            .on('click','#entryInfoEditBtn', function(){
                let closebtn = $('#updateEntryCanvasClose');
                closebtn.attr('data-bs-target','#entryInfoCanvas').attr('aria-controls','entryInfoCanvas');
            })
            .on('click', '.entry-update', function() {
                /* let entry = $(this).closest('.entry-card');
                let id = entry.data('id');
                let title = entry.data('title');
                let year = entry.data('year');
                let month = entry.data('month');
                let subsl = entry.data('subsl');
                let account = entry.data('account');
                let team = entry.data('team'); 
                let recognition = entry.data('recognition') ? "Individual" : "Team";
                let recipients = entry.data('recipients').split('/ ');
                let recipientHTML = "";
                let worktype = entry.data('worktype');
                let challenge = entry.data('challenge');
                let help = entry.data('help');
                let impact = entry.data('impact');
                let uniqueness = entry.data('uniqueness') && entry.data('uniqueness').trim().length > 0 ? entry.data('uniqueness') : "";

                */
                $('#attachmentsToDelete').val("[]")
                let id = $(this).attr('data-id');
                let entryItem = spItems[id];
                let title = entryItem.Title;
                let year = entryItem.Year;
                let month = entryItem.Month;
                let subsl = entryItem.SUBSL;
                let account = entryItem.Account;
                let team = entryItem.Team;
                let recognition = entryItem.Individual ? "Individual" : "Team";
                let recipients = entryItem.Recipients.split('/ ');
                let recipientEmails = entryItem.Recipient_x0020_Emails.split('/ ');
                let recipientHTML = "";
                let worktype = entryItem.Worktype;
                let challenge = entryItem.Challenge;
                let help = entryItem.Help;
                let impact = entryItem.Impact;
                let uniqueness = entryItem.Uniqueness && entryItem.Uniqueness.trim().length > 0 ? entryItem.Uniqueness : "";
                let classification = entryItem.Classification ? entryItem.Classification : "C&I PH Commendation";
                // let author = await getUserDetailsById(entry.data('author'));
                // let createdBy = author ? author.Title : "Unknown";
                $('#updateId').val(id);
                $('#updateEntryInput').val(title);
                $('#updateYearInput').val(year);
                $('#updateMonthDropdown').val(month);
                $('#updateSubslDropdown').val(subsl);
                $('#updateClassificationSelect').val(classification);
                //check if account exists in dropdown
                if($('#updateAccountDropdown option[value="'+account+'"]').length > 0){
                    $('#updateAccountDropdown').val(account);
                }else{
                    $('#updateAccountDropdown').val('other');
                    $('#updateOtherAccountInput').val(account).show().prop('required', true).attr('aria-required', 'true').focus();
                }
                $('#updateTeamInput').val(team);
                //make recipient pills per recipient
                $('#updateRecipientContainer').empty(); // Clear the recipient container
                recipients.forEach((recipient,index) => {
                    const newRecipient = $(`<div class="updateRecipientPill bg-secondary-subtle px-2" value="${recipientEmails[index]}" name="${recipient}">${recipient}<button class="updateRemoveRecipient" type="button"><i class="fa-solid fa-xmark"></i></button></div>`);
                    $('#updateRecipientContainer').append(newRecipient);
                });
                $('#updateRecipientDropdown').empty().hide(); // Clear the dropdown suggestions
                if(recipients.length > 0){
                    if(recipients.length == 1){
                        $('#updateRecognitionInput1').prop('checked', true);
                        $('#updateRecognitionInput2').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput1Label').addClass('bg-secondary-subtle');
                    }else{
                        $('#updateRecognitionInput2').prop('checked', true);
                        $('#updateRecognitionInput1').removeProp('checked').removeAttr('checked');
                        $('.updateRecognitionPill').removeClass('bg-secondary-subtle');
                        $('#updateRecognitionInput2Label').addClass('bg-secondary-subtle');
                    }
                    $('#recipientImages').val(""); // Clear the file input
                }
                //display preview of attachments
                $('#updatePreviewContainer').empty();
                $('#existingPreviewContainer').empty();
                displayExistingAttachmentsInUpdate(id)
                //check if worktype is others
                if($('#updateTypeOfWork option[value="'+worktype+'"]').length > 0){
                    $('#updateTypeOfWork').val(worktype);
                }else {
                    $('#updateTypeOfWork').val('others');
                    $('#updateOtherTypeOfWorkInput').show().prop('required', true).attr('aria-required', 'true').val(worktype);
                }
                    
                $('#updateBusinessChallengeInput').val(challenge);
                $('#updateHowDXCHelpedInput').val(help);
                $('#updateBusinessImpactInput').val(impact);
                //check if uniqueness has value
                if(uniqueness && uniqueness.trim().length > 0 && uniqueness != "N/A"){
                    $('#updateUniquenessTickbox').prop('checked', true);
                    $('#updateUniquenessInput').show().prop('required', true).attr('aria-required', 'true').val(uniqueness);
                }

                
            })
            .on('click','.entry-delete', function(){
                let id = $(this).attr('data-id');
                let entry = $('.entry-card[data-id="'+id+'"]');
                let entryItem = spItems[id];
                let title = entryItem.Title;
                let localTime = new Date();
                let utcOffset = 8 * 60 * 60 * 1000; // Convert GMT+8 offset to milliseconds
                let adjustedTime = new Date(localTime.getTime() + utcOffset).toISOString();
                let fields = [
                    {name: "Is_x0020_Deleted", value: true},
                    {name: "Deleted_x0020_By", value: email},
                    {name: "Deleted", value: adjustedTime}
                ];
                showConfirmModal(`Are you sure you want to delete the entry <b>${title}</b>?`,()=>{
                    updateSPItem("Amazing Stories entries", id, fields).then(()=>{
                        showModal("Success", "Entry deleted successfully.");
                        entry.remove();
                    }).catch((error) => {
                        console.error("Error deleting entry:", error);
                        showModal("Error", "An error occurred while deleting the entry. Please try again.");
                    })
                })
                
            })
            .on('click','.entry-amplify',function(){
                let id = $(this).attr('data-id');
                let entry = $('.entry-card[data-id="'+id+'"]');
                let entryItem = spItems[id];
                let title = entryItem.Title;
                let amplified = $(this).attr('data-amplified');
                let color = "";
                let updateValue = "Entry";
                let statusMessage = ["nominate", "amplify", "unamplify"];
                let statusMessageIndex = 2;
                switch(amplified){
                    case "Entry":
                        updateValue = "Candidate";
                        statusMessageIndex = 0;
                        color = "text-theme2";
                        break;
                    case "Candidate":
                        updateValue = "Amplified";
                        statusMessageIndex = 1;
                        color = "text-theme";
                        break;
                    case "Amplified":
                        updateValue = "Entry";
                        statusMessageIndex = 2;
                        break;
                }
                
                let fields = [{name: "Amplified", value: updateValue}];
                $(this).attr('title', `Click to ${statusMessage[statusMessageIndex]} this entry.`)
                showConfirmModal(`Are you sure you want to ${statusMessage[statusMessageIndex]} the entry <b>${title}</b>?`,()=>{
                    updateSPItem("Amazing Stories entries", id, fields).then(()=>{
                        showModal("Success", `Entry updated successfully.`);
                        // $(this).removeClass('text-theme text-theme2').addClass(color)
                        $(this).attr('data-amplified', updateValue);
                        statusMessageIndex = statusMessageIndex == 2 ? 0 : statusMessageIndex+1;
                        $(this).attr('title', `Click to ${statusMessage[statusMessageIndex]} this entry.`)
                        entryItem.Amplified = updateValue;
                        let labelId = $('input[name="entryFilter"]:checked').val();
                        $('.entryFilterLabel[value="'+labelId+'"]').click();
                    }).catch((error) => {
                        console.error("Error updating entry:", error);
                        showModal("Error", "An error occurred while updating the entry. Please try again.");
                    })
                })
            })
            .on('change','#sorter',function(){
                let sort = $(this).val();
                let month = $('#monthFilter').val();
                processListItems(spItems,month,sort);
            })
            .on('click','.entry-generate',function(){
                let attrid = $(this).attr('data-id');
                console.log("Generating presentation for entry ID:", attrid);
                createPresentation(spItems[attrid]);
            })
            
            .on('click','#generate',function(){
                let pptx = new PptxGenJS();
                // Create a new slide
                let slide = pptx.addSlide();

                // Add content to the slide
                slide.addText("Hello, Browser World!", { x: 1, y: 1, fontSize: 24, color: "FF0000" });

                // Generate the PowerPoint file
                pptx.writeFile("BrowserPresentation.pptx");

            })
        });
        async function init(){
            setCurrentMonth();
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const el = entry.target;
                        const bgUrl = el.getAttribute('data-bg');
                        el.style.backgroundImage = `url('${bgUrl}')`;
                        observer.unobserve(el); // Lazy load only once
                    }
                });
            });

            document.querySelectorAll('.lazy-bg').forEach(el => {
                observer.observe(el);
            });
            let status = await checkLoginStatus();
            if(status){
                getSiteAndDriveDetails();
                addFormValidation();
                // embedPowerBIReport();

                //check access level
                authorId = await getUserDetailsFromEmail(email);
                access = await userLevel();
                // dummydata();
                
            }
            $('#home-page').css('opacity', '1');
        }
        //ADD ENTRY FUNCTIONS
        function setCurrentMonth() {
            // Get the current month index (0 for January, 1 for February, etc.)
            const currentMonthIndex = new Date().getMonth();

            // Get the monthDropdown element
            const monthDropdown = document.getElementById("monthDropdown");

            // Set the selected option to the current month
            monthDropdown.selectedIndex = currentMonthIndex;
            

        }
            // Function to update fileInput with the remaining files
        function updateFileInput(filesArray, id) {
            const fileInput = document.getElementById(id);
            const dataTransfer = new DataTransfer(); // Create a new DataTransfer object
            
            filesArray.forEach(file => {
                dataTransfer.items.add(file); // Add the remaining files to the DataTransfer object
            });
            
            fileInput.files = dataTransfer.files; // Update fileInput's FileList
        }

        //ENTRIES FUNCTIONS
        async function viewItem(id){
            let entryItem = spItems[id];
            let title = entryItem.Title;
            let year = entryItem.Year;
            let month = entryItem.Month;
            let subsl = entryItem.SUBSL;
            let account = entryItem.Account;
            let team = entryItem.Team;
            let recognition = entryItem.Individual ? "Individual" : "Team";
            let recipients = entryItem.Recipients.split('/ ');
            let recipientHTML = "";
            let worktype = entryItem.Worktype;
            let challenge = entryItem.Challenge.replace(/\n/g, "<br>");
            let help = entryItem.Help.replace(/\n/g, "<br>");
            let impact = entryItem.Impact.replace(/\n/g, "<br>");
            let uniqueness = entryItem.Uniqueness ? entryItem.Uniqueness.replace(/\n/g, "<br>") : "N/A";
            let author = await getUserDetailsById(entryItem.AuthorId);
            let createdBy = author ? author.Title : "Unknown";
            let createdOn = new Date(`${entryItem.Created}`);
            const options = { year: "numeric", month: "long", day: "numeric" };
            createdOn = createdOn.toLocaleDateString("en-US", options);
            let attachmentID = entryItem.Attachments ? entryItem.ID : null;
            let amplified = entryItem.Amplified;
            /* let title = entry.data('title');
            let year = entry.data('year');
            let month = entry.data('month');
            let subsl = entry.data('subsl');
            let account = entry.data('account');
            let team = entry.data('team');
            let recognition = entry.data('recognition') ? "Individual" : "Team";
            let recipients = entry.data('recipients').split('/ ');
            let recipientHTML = "";
            let worktype = entry.data('worktype');
            let challenge = entry.data('challenge');
            let help = entry.data('help');
            let impact = entry.data('impact');
            let uniqueness = entry.data('uniqueness') ? entry.data('uniqueness') : "N/A";
            let author = await getUserDetailsById(entry.data('author'));
            let createdBy = author ? author.Title : "Unknown";
            let createdOn = entry.data('createdOn');
            let attachmentID = entry.data('attachments'); */
            let logo = getAccountLogo(account);
            $('#entryInfoEntry').text(title);
            $('#entryInfoYear').text(year);
            $('#entryInfoMonth').text(month);
            $('#entryInfoSubSL').text(subsl);
            $('#entryInfoTeam').text(team);
            $('#entryInfoCreatedBy').text(createdBy);
            $('#entryInfoCreatedOn').text(createdOn);
            $('#entryInfoLogo').attr('src', logo);
            recipients.forEach(recipient => {
                recipientHTML += `${recipient}<br>`
            });
            $('#entryInfoRecipients').html(recipientHTML);
            $('#entryInfoLogo').attr("src", getAccountLogo(account));
            $('#entryInfoWorkType').text(worktype);
            $('#entryInfoChallenge').html(challenge);
            $('#entryInfoImpact').html(impact);
            $('#entryInfoUniqueness').html(uniqueness);
            $('#entryInfoHelp').html(help);
            if(attachmentID){
                await displayAttachments(attachmentID).then(()=>{
                    $('#entryInfoImages').fadeIn();
                }).catch((error) => {
                    $('#entryInfoImages').html(`<p>Error retrieving attachments</p>`)
                    console.error("Error retrieving attachments:", error);
                });
            }else{
                $('#entryInfoImages').html(`<p>No attachments.</p>`)
            }
            $('#entryInfoAmplifyBtn').attr('data-amplified', amplified);
            $('#entryLoading').removeClass('d-flex').addClass('d-none');
            $('#entryInfoActions button').attr('data-id', id);
            $('#entryInfoCard').fadeIn();
        }
        async function getEntryById(id){
            let fields = [
                "Title","Year","Month","SUBSL","Account","Team","Individual","Recipients","Recipient_x0020_Emails","Worktype","Challenge","Help","Impact","Uniqueness","Outcome","Amplified",'Id','AuthorId', "Classification"
            ];
            let conditions = [{field:"ID", value: id}];
            let data = await getListWithSP_API("Amazing Stories entries",fields,conditions);
            
            if(data.length > 0)
                return data[0]; // Return the first item
            else
                console.log("No data found");
            
        }
        async function getAllEntriesByMonth(month){
            let sort = $('#sorter').val();
            $('#entriesContainer').html(loadingHTML());
            let fields = [
                "Title","Year","Month","SUBSL","Account","Team","Individual","Recipients","Recipient_x0020_Emails","Worktype","Challenge","Help","Impact","Uniqueness","Outcome","Amplified",'Id','AuthorId', "Classification"
            ];
            let conditions = [];
            if(month != 'All'){
                conditions = [{field:"Month", value: month}];
            }
            if(access.type == 1){
                let selectedSubSL = $('#subslFilter').val();
                if(selectedSubSL != 'All'){
                    conditions.push({field:"SUBSL", value: selectedSubSL});
                }
            }else if(access.type == 2){
                conditions.push({field:"SUBSL", value: access.subsl});
            }
            // conditions.push({field:"Is_x0020_Deleted", value: false});
            getListWithSP_API("Amazing Stories entries",fields,conditions).then(data=>{
                if(data.length > 0)
                    processListItems(data,month,sort); // Process the retrieved items
                else
                    $('#entriesContainer').html(noContentHTML());
            }).catch((error) => {
                console.error("Error retrieving data:", error);
            });
        }
        async function getSelfEntriesByMonth(month){
            let sort = $('#sorter').val();
            $('#entriesContainer').html(loadingHTML());
            let fields = [
                "Title","Year","Month","SUBSL","Account","Team","Individual","Recipients","Recipient_x0020_Emails","Worktype","Challenge","Help","Impact","Uniqueness","Outcome","Amplified",'Id','AuthorId', "Classification"
            ];
            let conditions = [];
            if(month != 'All'){
                conditions = [{field:"Month", value: month}];
            }
            if(access.type == 1){
                let selectedSubSL = $('#subslFilter').val();
                if(selectedSubSL != 'All'){
                    conditions.push({field:"SUBSL", value: selectedSubSL});
                }
            }else if(access.type == 2){
                conditions.push({field:"SUBSL", value: access.subsl});
            }
            
            // conditions.push({field:"Is_x0020_Deleted", value: false});
            getListWithSP_API("Amazing Stories entries",fields,conditions,email).then(data=>{
                if(data.length > 0)
                    processListItems(data,month,sort); // Process the retrieved items
                else
                    $('#entriesContainer').html(noContentHTML());
            }).catch((error) => {
                console.error("Error retrieving data:", error);
            });

            
        }
        async function getOwnRecognition(month) {
            let sort = $('#sorter').val();
            $('#entriesContainer').html(loadingHTML());
            try {
                let fields = ["Id", "Recipient_x0020_Emails"];
                let conditions = [];
                if(month != 'All'){
                    conditions = [{field:"Month", value: month}];
                }
                let data = await getListWithSP_API("Amazing Stories entries", fields, conditions);
                if (data && data.length > 0) {
                    
                    let fields = [
                        "Title", "Year", "Month", "SUBSL", "Account", "Team", "Individual", 
                        "Recipients", "Recipient_x0020_Emails", "Worktype", "Challenge", "Help", 
                        "Impact", "Uniqueness", "Outcome", "Amplified", "Id", "AuthorId", "Classification", "Submitted_x0020_By", "Created"
                    ];
                    let filteredData = data.filter(item => item.Recipient_x0020_Emails.includes(email));
                    if(filteredData.length == 0){
                        $('#entriesContainer').html(noContentHTML());
                        return false;
                    }
                    let ids = filteredData.map(datum => datum.Id);
                    if(month != 'All'){
                        conditions = [{field:"Month", value: month}];
                    }
                    let filterQuery = ids.map(id => month !== 'All' ? `(ID eq ${id} and Month eq '${month}')` : `(ID eq ${id})`).join(' or ');
                    let selectQuery = fields.join(',');

                    const url = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/getByTitle('Amazing Stories entries')/items?$filter=${filterQuery}&$select=${selectQuery}`;
                    const token = await getSharePointToken();
                    const response = await fetch(url, {
                        method: "GET",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Accept": "application/json;odata=verbose"
                        }
                    });

                    const responseData = await response.json();
                    console.log(responseData);
                    if(responseData.d.results.length > 0)
                        processListItems(responseData.d.results,month,sort); // Process the retrieved items
                    else
                        $('#entriesContainer').html(noContentHTML());
                } else {
                    $('#entriesContainer').html(noContentHTML());
                }
            } catch (error) {
                console.log(error);
                showModal("Error", "Error fetching data. Please try again.");
            }
        }
        function getAccountLogo(account){
            let img = "";
            switch(account){
                case "ADBRI": img = "ADBRI"; break;
                case "AgGateway":  img = "AgGateway"; break;
                case "Airbus": img = "Airbus"; break;
                case "Amcor": img = "Amcor"; break;
                case "AON": img = "AON"; break;
                case "AT&T": img = "AT&T"; break;
                case "Audi": img = "Audi"; break;
                case "Avanos": img = "Avanos Medical"; break;
                case "Aviva": img = "Aviva Canada"; break;
                case "BOQ": img = "BOQ"; break;
                case "Betafence": img = "Betafence"; break;
                case "BlueScope": img = "BlueScope"; break;
                case "Calvo": img = "Calvo"; break;
                case "CIBC": img = "CIBC"; break;
                case "Coca-Cola": img = "Coca Cola"; break;
                case "DirecTV": img = "DIRECTV"; break;
                case "Duracell": img = "Duracell"; break;
                case "Downer": img = "Downer EDI Limited"; break;
                case "DXC Technology": img = "DXCTechnology"; break;
                case "Fischer": img = "Fischer"; break;
                case "Glanbia": img = "Glanbia"; break;
                case "Global Life Sciences Products and Services": img = "Global Life Sciences Products & Services"; break;
                case "Haleon": img = "Haleon"; break;
                case "Hanes Brands Inc.": img = "Hanes Brands Inc."; break;
                case "HF Sinclair": img = "HF Sinclair"; break;
                case "Hitachi": img = "Hitachi"; break;
                case "HSC BSO": img = "HSC BSO"; break;
                case "IAG": img = "IAG"; break;
                case "Japan Tobacco Inc.": img = "Japan Tobacco Inc."; break;
                case "Jollibee Foods Corporation": img = "JFC"; break;
                case "KBR": img = "KBR"; break;
                case "Kraft Heinz": img = "Kraft Heinz"; break;
                case "Leveraged": return null; break;
                case "Latitude Financial Services": img = "Latitude Financial Services"; break;
                case "Macquarie": img = "Macquarie"; break;
                case "Markem-Imaje": img = "Markem Imaje"; break;
                case "Medmix": img = "Medmix"; break;
                case "Microsoft": img = "Microsoft"; break;
                case "Nestle": img = "Nestle"; break;
                case "Nissan": img = "Nissan"; break;
                case "ONE": img = "ONE"; break;
                case "Oceana": img = "Oceana"; break;
                case "Origin": img = "Origin"; break;
                case "Philips": img = "Philips"; break;
                case "P&G": img = "P&G"; break;
                case "Pilmico": img = "Pilmico"; break;
                case "Radisson": img = "Radisson Hotel Group"; break;
                case "Ralph Lauren": img = "Ralph Lauren"; break;
                case "Sabre": img = "Sabre"; break;
                case "Serco": img = "Serco"; break;
                case "Siam Cement Group": img = "Siam Cement Group"; break;
                case "Sonneborn" : img = "Sonneborn"; break;
                case "Sotheby's": img = "Sothebys"; break;
                case "South Australian Health": img = "South Australian Health"; break;
                case "Sulzer": img = "Sulzer"; break;
                case "ThyssenKrupp": img = "ThyssenKrupp"; break;
                case "Toronto Dominion Bank": img = "Toronto Dominion Bank"; break;
                case "Tops Markets LLC": img = "Tops"; break;
                case "Uniper": img = "Uniper"; break;
                case "Valeo": img = "Valeo"; break;
                case "Ventia": img = "Ventia"; break;
                case "Western Sydney Airport": img = "Western Sydney Airport"; break;
                case "Western Union": img = "Western Union"; break;
                case "Westpac": img = "Westpac"; break;
                case "Whitehaven Coal": img = "Whitehaven Coal"; break;
                case "W.L. Gore": img = "W.L. Gore"; break;
                case "Worksafe Victoria": img = "WorkSafe Victoria"; break;
                case "ZF WABCO": img = "ZF Wabco"; break;
                default: return null; break;
            }
            return "assets/img/logos/"+img + ".jpg";
        }
        async function getAttachments(itemID) {
            try{
                const token = await getSharePointToken(); // Get a new token for SharePoint API
                const response = await fetch(`https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/Web/Lists/GetByTitle('Amazing Stories entries')/items(${itemID})/AttachmentFiles`, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Accept": "application/json;odata=verbose"
                    }
                });
                const data = await response.json();
                return data.d.results; // Returns an array of attachments
                
            }catch(error){
                console.log(error);
                return null;
            }
            
        }
        async function displayAttachments(itemID) {
            const attachments = await getAttachments(itemID);
            let html = "";

            attachments.forEach(file => {
                html += `<img src="https://dxcportal.sharepoint.com${file.ServerRelativeUrl}" data-name="${file.FileName}" alt="Attachment" style="max-width: 200px; margin: 5px;">`;
            });

            document.getElementById("entryInfoImages").innerHTML = html;
        }
        async function displayExistingAttachmentsInUpdate(itemID) {
            const attachments = await getAttachments(itemID);
            let previewContainer = document.getElementById("existingPreviewContainer");
            if(attachments.length == 0){
                previewContainer.innerHTML = `<p>No images.</p>`;
                return false;
            }
            attachments.forEach((file, index) => {
                // html += `<img src="https://dxcportal.sharepoint.com${file.ServerRelativeUrl}" data-name="${file.FileName}" alt="Attachment" style="max-width: 200px; margin: 5px;">`;
                
                const div = document.createElement('div'); // Create a wrapper div
                div.classList.add('image-wrapper', 'existing'); // Optional: Add a class for styling
                const img = document.createElement('img');
                img.src = `https://dxcportal.sharepoint.com${file.ServerRelativeUrl}`;
                const button = document.createElement('button'); // Create a button
                button.innerHTML = '<i class="fa-solid fa-xmark"></i>'; // Add the icon
                button.classList.add('remove-image-button');
                button.type = 'button';
                const restorebutton = document.createElement('button'); // Create a button
                restorebutton.innerHTML = '<i class="fa-solid fa-rotate-right"></i>'; // Add the icon
                restorebutton.classList.add('restore-image-button');
                restorebutton.type = 'button';
                // Create the overlay
                const overlay = document.createElement('div');
                overlay.classList.add('image-overlay');
                overlay.innerText = "Marked for deletion"; // Optional label
                // Add click event to remove the preview and update the file list
                button.addEventListener('click', function() {
                    // temporarily store the file name in json
                    let attachmentsToDelete = JSON.parse($('#attachmentsToDelete').val());
                    if (!attachmentsToDelete.includes(file.FileName)) {
                        attachmentsToDelete.push(file.FileName);
                    }
                    $('#attachmentsToDelete').val(JSON.stringify(attachmentsToDelete));
                    // Show the overlay instead of removing the image
                    overlay.style.display = "flex";
                    restorebutton.style.display = "block"; // Show the restore button
                    button.style.display = "none"; // Hide the remove button
                    $(this).closest('.image-wrapper').addClass('marked-for-deletion');
                });
                restorebutton.addEventListener('click', function() {
                    // temporarily store the file name in json
                    let attachmentsToDelete = JSON.parse($('#attachmentsToDelete').val());
                    //remove file name from list
                    attachmentsToDelete = attachmentsToDelete.filter(item => item !== file.FileName);

                    $('#attachmentsToDelete').val(JSON.stringify(attachmentsToDelete));
                    overlay.style.display = "none"; //Hide the overlay
                    restorebutton.style.display = "none"; // Hide the restore button
                    button.style.display = "block"; // Show the remove button
                    $(this).closest('.image-wrapper').removeClass('marked-for-deletion');
                });


                div.appendChild(img); // Append the image to the wrapper div
                div.appendChild(button); // Append the button to the wrapper div
                div.appendChild(restorebutton); // Append the button to the wrapper div
                div.appendChild(overlay); // Add overlay but keep it hidden initially
                previewContainer.appendChild(div); // Add the image to the preview container
            });

        }
        function filterEntryList(month,filter){
            switch(filter){
                case '1': //all entries
                    getAllEntriesByMonth(month);
                    break;
                case '2': //own entries
                    getSelfEntriesByMonth(month);
                    break;
                case '3': //own recognition
                    getOwnRecognition(month);
                    break;
            }
        }
        async function processListItems(items,month, sort = 0) {
            let target = $('#entriesContainer')//$('#'+month+'Entries');
            let html = ``;
            spItems = []; // clear spItems
            // Sort items based on sort
            switch(sort){
                case '1':
                    items.sort((a, b) => new Date(a.Created) - new Date(b.Created)); // Sort by Created date ascending
                    break;
                case '2':
                    items.sort((a, b) => new Date(b.Created) - new Date(a.Created)); // Sort by Created date descending
                    break;
                case '3':
                    items.sort((a, b) => a.Submitted_x0020_By.localeCompare(b.Submitted_x0020_By)); // Sort by Submitted By ascending
                    break;
                case '4':
                    items.sort((a, b) => b.Submitted_x0020_By.localeCompare(a.Submitted_x0020_By)); // Sort by Submitted By descending
                    break;
                case '5':
                    items.sort((a, b) => monthNames.indexOf(a.Month) - monthNames.indexOf(b.Month)); // sort by month ascending
                    break;
                case '6':
                    items.sort((a, b) => monthNames.indexOf(b.Month) - monthNames.indexOf(a.Month)); // sort by month descending
                    break;
                case '7':
                    items.sort((a, b) => a.Account.localeCompare(b.Account));; // sort by account ascending
                    break;
                case '8':
                    items.sort((a, b) => b.Account.localeCompare(a.Account));; // sort by account ascending
                    break;
                default:
                    items.sort((a, b) => new Date(b.Created) - new Date(a.Created));
            }
            
            if(items.length > 0){
                for( const item of items){
                    if(!item || !item.Id){ continue;}
                    spItems[item.Id] = item;
                    var uniqueness = item.Uniqueness ? item.Uniqueness : "N/A";
                    var recognition = item.Individual ? "Individual" : "Team";
                    var createdOn = new Date(`${item.Created}`);
                    const options = { year: "numeric", month: "long", day: "numeric" };
                    createdOn = createdOn.toLocaleDateString("en-US", options);
                    var attachments = item.Attachments ? item.ID : null;
                    let category = "Entry";
                    if(access.type == 1){
                        category = item.Amplified;
                    }
                    html += `<div class="card entry-card my-1 ${category} position-relative entry-preview" data-id="${item.Id}">`
                    
                    html+=`<div class="card-body">
                            <div style="max-width: 75%;">
                                <span class="lead" entry-id="${item.Id}" style="cursor: pointer">${item.Title}</span><br>
                                <span><b>${item.SUBSL}</b> | ${item.Account}`;
                    if(month == 'All'){
                        html += ` | ${item.Month}, ${item.Year}`;
                    }
                    html += ` | Entry by: ${item.Submitted_x0020_By}</span>`;
                    html+=`</span>
                            </div>`
                    html+= `<div class="entry-actions">`;
                    
                    html+=`<button type="button" title="View Info" data-id="${item.Id}" data-bs-toggle="offcanvas" data-bs-target="#entryInfoCanvas" aria-controls="entryInfoCanvas" class="entry-view"><i class="fa-solid fa-right-to-bracket"></i></button>`
                    
                    // if((authorId == item.AuthorId && access.type == 2) || access.type == 1){            
                    //     html += `<button type="button" title="Edit" data-id="${item.Id}" data-bs-toggle="offcanvas" data-bs-target="#updateEntryCanvas" aria-controls="updateEntryCanvas" class="entry-update"><i class="fa-solid fa-pen"></i></button>
                    //             <button class="entry-delete" title="Delete" data-id="${item.Id}"><i class="fa-solid fa-trash-can"></i></button>`;
                    // }
                    // html += `<button title="Generate slides" class="entry-generate" data-id="${item.Id}"><i class="fa-solid fa-file-powerpoint"></i></button>`;
                    html +=       `</div>`; //close entry-actions
                    html+=`</div>
                    </div>`;
                };
            }else{
                html = noContentHTML();
            }
            
            target.html(html);
        }
        
        // GENERATE SLIDE FUNCTIONS
        




        //DASHBOARD FUNCTIONS
        function embedPowerBIReport() {
            const embedConfig = {
                type: "report",
                id: "<report-id>",
                embedUrl: "<embed-url>",
                accessToken: "<access-token>",
                settings: {
                panes: {
                    filters: {
                    visible: false, // Hides filters pane
                    },
                },
                layoutType: models.LayoutType.Custom, // Required for custom layout
                navContentPaneEnabled: false, // Hides page navigation bar
                },
            };

            // Embed the Power BI report into the container
            const reportContainer = document.getElementById("reportContainer");
            const report = powerbi.embed(reportContainer, embedConfig);
        }


        
        
        //GRAPH FUNCTIONS
        async function saveToSharePoint(listName, data, attachments = []) {
            // URL to create the list item
            const url = `https://graph.microsoft.com/v1.0/sites/dxcportal.sharepoint.com:/sites/ITOEECoreTeam:/lists/${listName}/items`;
            const token = await getToken();

            if (token) {
                try {
                    // Step 1: Save the main list item
                    const response = await fetch(url, {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ fields: data })
                    });

                    if (!response.ok) {
                        throw new Error(`Error saving to SharePoint: ${response.statusText}`);
                    }

                    const result = await response.json();
                    console.log(result)
                    console.log("List item saved successfully");

                    // Step 2: Upload attachments (if any)
                    if (attachments.length > 0) {
                        const itemId = result.id; // Get the ID of the created list item
                        const attachmentBaseUrl = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/GetByTitle('${listName}')/items(${itemId})/AttachmentFiles/add(FileName='`;
                        const sharePointToken = await getSharePointToken(); // Get a new token for SharePoint API
                        for (const attachment of attachments) {
                            const attachmentName = attachment.name;
                            const fileData = await attachment.arrayBuffer(); // Read the file as binary data

                            const uploadResponse = await fetch(`${attachmentBaseUrl}${attachmentName}')`, {
                                method: "POST",
                                headers: {
                                    "Authorization": `Bearer ${sharePointToken}`,
                                    "Accept": "application/json;odata=verbose"
                                },
                                body: fileData
                            });

                            if (!uploadResponse.ok) {
                                throw new Error(`Error uploading attachment: ${uploadResponse.statusText}`);
                            }

                            console.log(`Attachment '${attachmentName}' uploaded successfully`);
                        }
                    }

                    // Return the result of the saved list item
                    return result;

                } catch (error) {
                    console.error(error);
                    throw new Error(`Failed to save item or attachments: ${error.message}`);
                }
            } else {
                throw new Error("Failed to retrieve authorization token");
            }
        }
        async function saveToSharePointBatch(listName, dataArray) {
            const url = "https://graph.microsoft.com/v1.0/$batch"; // Graph API batch endpoint
            const token = await getToken();

            if (token) {
                const batchSize = 20; // Maximum requests per batch
                const batches = [];
                let totalEntries = dataArray.length; // Total number of entries to insert
                let successCount = 0; // Counter for entries with 201 status

                // Split dataArray into batches of 20
                for (let i = 0; i < dataArray.length; i += batchSize) {
                    const batch = dataArray.slice(i, i + batchSize);
                    batches.push(batch);
                }

                for (const batch of batches) {
                    const batchRequests = batch.map((item, index) => ({
                        id: `${index + 1}`, // Unique ID for each request
                        method: "POST",
                        url: `/sites/dxcportal.sharepoint.com:/sites/ITOEECoreTeam:/lists/${listName}/items`,
                        body: { fields: item },
                        headers: {
                            "Content-Type": "application/json"
                        }
                    }));

                    // Prepare batch payload
                    const batchPayload = { requests: batchRequests };

                    // Send batch request
                    const response = await fetch(url, {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(batchPayload)
                    });

                    if (!response.ok) {
                        console.error(`Error in batch request: ${response.statusText}`);
                    } else {
                        const result = await response.json();

                        // Check individual responses for errors and count successes
                        result.responses.forEach((res) => {
                            if (res.status === 201) {
                                successCount++;
                            } else if (res.status === 400) {
                                console.error(`Error in item ${res.id}: ${res.body.error.message}`);
                            }
                        });
                    }
                }

                // Compare counters and trigger appropriate response
                if (successCount === totalEntries) {
                    showModal("Success", "All entries were saved successfully!","success");
                } else if (successCount > 0) {
                    showModal(
                        "Partial Success",
                        `${successCount} out of ${totalEntries} entries were saved successfully. Check logs for errors.`,
                        'fail'
                    );
                } else {
                    showModal("Error", "No entries were saved. Please check the logs for details.",'fail');
                }
            }
        }
        async function getFromSharePoint(listName, fields, conditions) {
            const url = `https://graph.microsoft.com/v1.0/sites/dxcportal.sharepoint.com:/sites/ITOEECoreTeam:/lists/${listName}/items`;
            const token = await getToken();

            if (token) {
                try {
                    // Build the query string for filtering conditions
                    let filterQuery = [];

                    // Add conditions filters
                    if (conditions && conditions.length > 0) {
                        conditions.forEach(cond => {
                            filterQuery.push(`fields/${cond.field} eq '${cond.value}'`);
                        });
                    }

                    // Construct the URL with $expand and $filter
                    let requestUrl = `${url}?$expand=fields`;
                    if (filterQuery.length > 0) {
                        requestUrl += `&$filter=${filterQuery.join(" and ")}`;
                    }
                    console.log(requestUrl);
                    // Fetch items from the SharePoint list
                    const response = await fetch(requestUrl, {
                        method: "GET",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json"
                        }
                    });

                    if (!response.ok) {
                        throw new Error(`Error fetching from SharePoint: ${response.statusText}`);
                    }

                    const result = await response.json();
                    var filteredItems = [];
                    
                    
                    // Post-process to return only the specified fields, including 'createdBy'
                    if (!fields || fields.length === 0) {
                        filteredItems = result.value.map(item => ({
                            ...item.fields, // Spread operator to keep all fields
                            createdBy: item.createdBy.user // Include createdBy details
                        }));
                    } else {
                        filteredItems = result.value.map(item => {
                            const processedItem = {};
                            fields.forEach(field => {
                                processedItem[field] = item.fields[field]; // Extract only the specified fields
                            });
                            // Add 'createdBy' information
                            processedItem.createdBy = item.createdBy.user;
                            return processedItem;
                        });
                    }

                    console.log("Filtered Items:", filteredItems);
                    return filteredItems; // Return the processed items
                } catch (error) {
                    console.error("Error retrieving data from SharePoint:", error);
                    throw error;
                }
            } else {
                throw new Error("Failed to obtain authentication token.");
            }
        }
            /* 
            listName = name of list in sharepoint
            data = array of objects to update. each object must have an "id" field
            */
        async function getListWithSP_API(listName, fields=[], conditions=[], author = null) {
            const token = await getSharePointToken();
            if (!token) {
                throw new Error("Failed to obtain authentication token.");
                showModal("Error","Failed to obtain authentication token. Please refresh the page and try again.")
            };

            try {
                const url = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/GetByTitle('${listName}')/items`;
                let filterQuery = [];

                // Filter by Created By (AuthorId)
                if (author) {
                    
                    const userID = await getUserDetailsFromEmail(author ? author : email);
                    filterQuery.push(`AuthorId eq ${userID}`);
                }

                // Add other conditions (direct properties, NOT fields/)
                if (conditions && conditions.length > 0) {
                    conditions.forEach(cond => {
                        filterQuery.push(`${cond.field} eq '${cond.value}'`);
                    });
                }
                if(listName == "Amazing Stories entries")
                    filterQuery.push("Is_x0020_Deleted eq false"); // Ensure we only get non-deleted items

                // Construct final request URL
                let requestUrl = url;
                if (filterQuery.length > 0) {
                    requestUrl += `?$filter=${filterQuery.join(" and ")}`;
                }
                const response = await fetch(requestUrl, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Content-Type": "application/json",
                        "Accept": "application/json;odata=verbose"
                    }
                });

                if (!response.ok) {
                    throw new Error(`Error fetching from SharePoint: ${response.statusText}`);
                }

                const result = await response.json();
                const items = result.d?.results || []; // Ensure we reference d.results

                // Retrieve CreatedBy (AuthorId) details separately
                const processedItems = await Promise.all(items.map(async item => {
                    return {
                        ...item, // Keep all direct properties
                    };
                }));

                // console.log("Filtered Items:", processedItems);
                return processedItems; 
            } catch (error) {
                console.error("Error retrieving data from SharePoint:", error);
                showModal("Error","Error retrieving data from SharePoint")
                throw error;
            }
        }
        async function updateSPItem(listName, id, fieldsArray) {
            const token = await getSharePointToken();
            if (!token) {
                throw new Error("Failed to obtain authentication token.");
                showModal("Error", "Failed to obtain authentication token. Please refresh the page and try again.");
            }

            try {
                const url = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/GetByTitle('${listName}')/items(${id})`;

                // Convert the array to an object for SharePoint API
                const fieldsObject = fieldsArray.reduce((acc, field) => {
                    acc[field.name] = field.value;
                    return acc;
                }, {});

                const response = await fetch(url, {
                    method: "PATCH",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Content-Type": "application/json",
                        "X-HTTP-Method": "MERGE",
                        "IF-MATCH": "*",
                        "Accept": "application/json;odata=verbose"
                    },
                    body: JSON.stringify(fieldsObject)
                });

                if (!response.ok) {
                    throw new Error(`Error updating SharePoint item: ${response.statusText}`);
                }

                console.log("Item updated successfully");
            } catch (error) {
                console.error("Error updating item:", error);
                showModal("Error", "Error updating item");
                throw error;
            }
        }
        

        async function updateToSharePoint(listName, data) {
            const url = `https://graph.microsoft.com/v1.0/sites/dxcportal.sharepoint.com:/sites/ITOEECoreTeam:/lists/${listName}/items`;
            const token = await getToken();

            if (token) {
                try {
                    // Validate that data contains an 'id' column
                    if (!data.every(item => item.id)) {
                        throw new Error("Each item in 'data' must have an 'id' field.");
                    }

                    // Prepare batch request payload
                    const batchRequest = {
                        requests: data.map(item => {
                            const requestUrl = `${url}/${item.id}`; // Use 'id' field for identifying the item
                            return {
                                id: item.id, // Unique identifier for batch request
                                method: "PATCH",
                                url: requestUrl,
                                headers: {
                                    "Authorization": `Bearer ${token}`,
                                    "Content-Type": "application/json"
                                },
                                body: {
                                    fields: { ...item } // Spread the key-value pairs from the current item
                                }
                            };
                        })
                    };

                    // Send batch request
                    const batchResponse = await fetch(`https://graph.microsoft.com/v1.0/$batch`, {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(batchRequest)
                    });

                    if (!batchResponse.ok) {
                        throw new Error(`Error in batch update: ${batchResponse.statusText}`);
                    }

                    const result = await batchResponse.json();
                    console.log("Batch update response:", result);

                    console.log("All items updated successfully.");
                    return result;
                } catch (error) {
                    console.error("Error updating data to SharePoint:", error);
                    throw error;
                }
            } else {
                throw new Error("Failed to obtain authentication token.");
            }
        }
        async function signIn() {
            try {
                // Handle the redirect after login
                const redirectResponse = await msalInstance.handleRedirectPromise();

                if (redirectResponse) {
                    console.log("Login successful:");
                    checkLoginStatus(); // Ensure this runs after a successful login
                    return; // Stop further execution after reload
                }

                const accounts = msalInstance.getAllAccounts();
                if (accounts.length === 0) {
                    // Initiate login redirect
                    await msalInstance.loginRedirect({
                        scopes: ["email", "openid","User.ReadBasic.All", "profile", "user.read", "Sites.Read.All", "Sites.ReadWrite.All"], // Initial scopes
                    });
                    checkLoginStatus(); // Ensure this runs after a successful login
                    window.location.reload();
                } else {
                    
                    checkLoginStatus(); // Account already exists
                }
            } catch (error) {
                console.error("Login error:", error);
                showModal("Login Error", "There was an error signing in. Please refresh the browser and try again.");
            }
        }
        async function getAccountInfo() {
            const token = await getToken();
            if (token) {
                const accounts = msalInstance.getAllAccounts();
                accountName = (accounts[0].name).trim();
                email = (accounts[0].username).trim();

                console.log("Account Name:", accountName, "Email:", email);
            }
        }

        // Function to fetch users from the tenant directory
        async function fetchTenantUsers(searchTerm) {
            try {
                // Acquire the access token using MSAL
                const account = msalInstance.getActiveAccount(); // Ensure there's a signed-in user
                const tokenResponse = await msalInstance.acquireTokenSilent({
                    scopes: ["User.ReadBasic.All"],
                    account: account,
                });

                const accessToken = tokenResponse.accessToken;

                // Call Microsoft Graph API to fetch users with filtering on first and last name
                const graphEndpoint = `https://graph.microsoft.com/v1.0/users?$select=id,displayName,givenName,surname,mail&$filter=startswith(givenName,'${searchTerm}') or startswith(surname,'${searchTerm}') or startswith(displayName,'${searchTerm}')`;

                const response = await fetch(graphEndpoint, {
                    headers: {
                        Authorization: `Bearer ${accessToken}`,
                        "Content-Type": "application/json",
                    },
                });

                if (!response.ok) {
                    throw new Error(`Error fetching data: ${response.statusText}`);
                }

                const data = await response.json();

                // Parse and return the relevant fields
                return data.value.map(user => ({
                    id: user.id,
                    name: user.displayName,
                    firstName: user.givenName || "No First Name",
                    lastName: user.surname || "No Last Name",
                    email: user.mail || "No Email",
                }));
            } catch (error) {
                console.error("Error fetching user data: ", error);
                return [];
            }
        }


       //SHAREPOINT FUNCTIONS
        async function getSharePointToken(){
            try{
                const accounts = msalInstance.getAllAccounts();
                const tokenResponse = await msalInstance.acquireTokenSilent({
                    scopes: ["https://dxcportal.sharepoint.com/.default"], // SharePoint API scope
                    account: accounts[0], // Use the first account
                });
                return tokenResponse.accessToken;
            } catch (error) {
                console.error("Error acquiring token:", error);
                if (error instanceof msal.InteractionRequiredAuthError) {
                    // Fallback to interactive token acquisition if silent acquisition fails
                    const loginResponse = await msalInstance.loginRedirect({
                        scopes: ["https://dxcportal.sharepoint.com/.default"], // SharePoint API scope
                    });
                    return loginResponse.accessToken;
                } else {
                    showModal("Notice", "Session expired. Please refresh the page and try again.");
                    throw error;
                }
            }
            
        }
        async function getSiteAndDriveDetails() {
            console.log("Fetching site and drive details.")
            const account = msalInstance.getAllAccounts()[0];
            tokenResponse = await msalInstance.acquireTokenSilent({
                scopes: ["Sites.Read.All", "Sites.ReadWrite.All"],
                account: account
            });
            // ACTION REQUIRED
            // Get the Site ID - change to new site
            const siteResponse = await fetch("https://graph.microsoft.com/v1.0/sites?search=ITOEECoreTeam", {
                headers: {
                    Authorization: `Bearer ${tokenResponse.accessToken}`
                }
            });

            const siteData = await siteResponse.json();
            siteId = siteData.value[0].id;

            // Get the Drive ID for the document library
            const driveResponse = await fetch(`https://graph.microsoft.com/v1.0/sites/${siteId}/drives`, {
                headers: {
                    Authorization: `Bearer ${tokenResponse.accessToken}`
                }
            });

            const driveData = await driveResponse.json();
            driveId = driveData.value[0].id; // Assuming the first drive is the document library

            // return { siteId, driveId, tokenResponse };
        }
        async function getGraphAttachments(siteId, listId, itemId, accessToken) {
            const endpoint = `https://graph.microsoft.com/v1.0/sites/${siteId}/lists/${listId}/items/${itemId}/attachments`;

            try {
                const response = await fetch(endpoint, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${accessToken}`,
                        "Content-Type": "application/json"
                    }
                });

                if (!response.ok) {
                    throw new Error(`Error fetching attachments: ${response.statusText}`);
                }

                const result = await response.json();
                console.log("Attachments:", result.value);
                return result.value; // Contains attachment details including download URLs
            } catch (error) {
                console.error("Error retrieving attachments:", error);
            }
        }
        async function getUserDetailsById(id) {
            try{
                const token = await getSharePointToken();
                const userResponse = await fetch(`https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/siteusers?$filter=Id eq ${id}&$select=Id,Title,Email`, {
                    headers: { "Authorization": `Bearer ${token}` , "Accept": "application/json;odata=verbose"}
                });
                const userData = await userResponse.json();
                return userData.d.results[0]; // Assuming only one match
            }catch(error){
                console.error("Failed to fetch user details:", error);
                return null;
            }
            
        }
        async function getUserDetailsFromEmail(email) {
            const token = await getSharePointToken();
            const userIdURL = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/siteusers?$filter=Email eq '${email}'&$select=Id,Title,Email`;
            const userResponse = await fetch(userIdURL, {
                        method: "GET",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json",
                            "Accept": "application/json;odata=verbose"
                        }
                    });
            const userResult = await userResponse.json();
            return userResult.d.results[0].Id;
        }
        async function userLevel(){
            const token = await getSharePointToken();
            if (!token) {
                throw new Error("Failed to obtain authentication token.");
                showModal("Error","Failed to obtain authentication token. Please refresh the page and try again.")
            };

            try {
                const url = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/GetByTitle('Amazing Stories POC List')/items?$filter=POCName/EMail eq '${email}'&$select=SUBSL/Title,POCName/Title,POCName/EMail,POCName/Id&$expand=SUBSL,POCName`;
                const response = await fetch(url, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${token}`,
                        "Content-Type": "application/json",
                        "Accept": "application/json;odata=verbose"
                    }
                });

                if (!response.ok) {
                    throw new Error(`Error fetching from SharePoint: ${response.statusText}`);
                }

                const result = await response.json();
                const items = result.d?.results || []; // Ensure we reference d.results

                // Retrieve CreatedBy (AuthorId) details separately
                const processedItems = await Promise.all(items.map(async item => {
                    return {
                        ...item, // Keep all direct properties
                    };
                }));
                /* 1 = Super, 2 = SPOC, 3 = others */
                let defaultaccess = {type: 3, subsl: "Others"};
                if(processedItems.length > 0){
                    let user = processedItems[0];
                    defaultaccess.subsl = user.SUBSL.Title;
                    if(defaultaccess.subsl == 'GIS'){
                        defaultaccess.type = 1; // Super Admin
                        $('.super-element').removeClass("d-none");
                    }else {
                        defaultaccess.type = 2; // SPOC
                        $('.super-element').remove();
                        //remove subsl options
                        $("#subslDropdown option, #updateSubslDropdown option").not("[value='" + defaultaccess.subsl + "']").remove();
                    }
                    $('.spoc-element').removeClass("d-none");
                }else{
                    //remove everything
                    $('.spoc-element').remove();
                    $('.super-element').remove();
                    $('.other-element').removeClass("d-none");
                }
                return defaultaccess; 

            } catch (error) {
                console.error("Error retrieving data from SharePoint:", error);
                showModal("Error","Error retrieving data from SharePoint")
                throw error;
            }
        }
        async function getFormDigest() {
            try {
                const token = await getSharePointToken();
                const response = await fetch(`https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/contextinfo`, {
                    method: "POST",
                    headers: {
                        "Accept": "application/json;odata=verbose",
                        "Authorization": "Bearer "+token
                    }
                });
                const data = await response.json();
                return data.d.GetContextWebInformation.FormDigestValue;
            } catch (error) {
                console.error("Error fetching request digest: ", error);
                return null;
            }
        }
        async function addAttachments(itemId, files) {
            const siteUrl = "";  // Replace with your site URL
            const listName = "YourListName";  // Replace with your list name

            try {
                const formDigest = await getFormDigest();  // Ensure you have a valid form digest

                for (const file of files) {
                    const fileName = file.name;
                    const token = await getSharePointToken();
                    const response = await fetch(`https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/getbytitle('Amazing Stories entries')/items(${itemId})/AttachmentFiles/add(FileName='${fileName}')`, {
                        method: "POST",
                        headers: {
                            "Accept": "application/json;odata=verbose",
                            "X-RequestDigest": formDigest,
                            "Authorization": "Bearer "+token,
                        },
                        body: file
                    });

                    if (!response.ok) {
                        throw new Error(`Upload failed for ${fileName}: ${response.statusText}`);
                        showModal("Error", `Upload failed for ${fileName}: ${response.statusText}`);
                    }

                    console.log(`Attachment uploaded successfully: ${fileName}`);
                }
            } catch (error) {
                console.error("Error uploading attachments:", error);
                showModal("Error", "Error uploading attachments: " + error.message);
            }
        }

        async function deleteAttachments(listName, itemId, fileNames) {
            const formDigest = await getFormDigest();
            if (!formDigest) {
                console.error("Could not retrieve request digest.");
                return;
            }
            const token = await getSharePointToken();
            for (let fileName of fileNames) {
                let endpoint = `https://dxcportal.sharepoint.com/sites/ITOEECoreTeam/_api/web/lists/GetByTitle('${listName}')/items(${itemId})/AttachmentFiles('${fileName}')`;

                try {
                    const response = await fetch(endpoint, {
                        method: "DELETE",
                        headers: {
                            "Accept": "application/json;odata=verbose",
                            "X-RequestDigest": formDigest,
                            "IF-MATCH": "*",
                            "X-HTTP-Method": "DELETE",
                            "Authorization": "Bearer "+token
                        }
                    });

                    if (!response.ok) {
                        throw new Error(`Failed to delete ${fileName}: ${response.statusText}`);
                    }

                    console.log(`Deleted: ${fileName}`);
                } catch (error) {
                    console.error(`Error deleting attachment (${fileName}):`, error);
                }
            }
        }


        //POWER AUTOMATE FUNCTIONSv
        async function sendEmail(beforeData, afterData) {
            // Create table structure
            let htmlTable = `
                <table border="1" style="border-collapse: collapse; width: 100%;">
                    <thead>
                        <tr>
                            <th style="padding: 8px; text-align: left;">Field</th>
                            <th style="padding: 8px; text-align: left;">Before</th>
                            <th style="padding: 8px; text-align: left;">After</th>
                            <th style="padding: 8px; text-align: left;">Modified By</th>
                            <th style="padding: 8px; text-align: left;">Modified On</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Loop through modified fields
            afterData.forEach(({ name, value }) => {
                let formattedName = name;
                if(name == "Recipient_x0020_Emails"){
                    formattedName = "Recipient Emails";
                }else if(name == "Recipient_x0020_Names"){
                    formattedName = "Recipient Names";
                }
                htmlTable += `
                    <tr>
                        <td style="padding: 8px;">${formattedName}</td>
                        <td style="padding: 8px;">${beforeData[name] || "N/A"}</td>
                        <td style="padding: 8px;">${value}</td>
                        <td style="padding: 8px;">${accountName}</td>
                        <td style="padding: 8px;">${new Date().toLocaleString()}</td>
                    </tr>
                `;
            });

            // Close table
            htmlTable += `
                    </tbody>
                </table>
            `;
            const requestData = {email: htmlTable};
            // const token = await getToken();
            flowUrl = "https://prod-59.westus.logic.azure.com:443/workflows/cd16bc1b918a4169b7b97fbe081aeb51/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=lsQ_obP9XwOg6WZ_-2FqJK3jw6sAX0ZbRLQHa7aQRhA"
            fetch(flowUrl, {
            method: "POST",
            headers: { 
                // "AUthorization": `Bearer ${token}`,
                "Content-Type": "application/json" 
            },
            body: JSON.stringify(requestData)

            })
            .then(async response => {
                console.log("Status Code:", response.status);

                if (!response.ok) {
                    console.error("Error response from Power Automate:", response.statusText);
                    return;
                }

                // Check if there's a response body
                const contentType = response.headers.get("Content-Type");
                
                if (contentType && contentType.includes("application/json")) {
                    const data = await response.json();
                    console.log("JSON Response:", data);
                } else {
                    console.log("No JSON body, raw response:", await response.text());
                }
            })
            .catch(error => console.error("Error:", error));
        }

        /* EXAMPLE USAGE
        const siteUrl = "https://dxcportal.sharepoint.com";
        const listName = "YourListName";
        const itemId = 123; // SharePoint list item ID
        const attachmentsToDelete = ["image1.jpg", "document.pdf"];

        deleteAttachments(siteUrl, listName, itemId, attachmentsToDelete);

        
        */
    
    </script>
</body>
</html>